function __xx_checkJquery(){function e(t){triggermail.__tm_initialized||t>100||(triggermail.__initializeWithoutJQuery||window.jQuery?(triggermail.initialize(),triggermail.__tm_initialized=!0):setTimeout(e,100,t+1))}if(window.jQuery){!function(){var e=!1,t=/var xyz/.test(function(){})?/\b_super\b/:/[\D|\d]*/;this.__tmClass=function(){},window.__tmClass=this.__tmClass,__tmClass.extend=function(r){function i(){!e&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;e=!0;var o=new this;e=!1;for(var a in r)o[a]="function"==typeof r[a]&&"function"==typeof n[a]&&t.test(r[a])?function(e,t){return function(){var r=this._super;this._super=n[e];var i=t.apply(this,arguments);return this._super=r,i}}(a,r[a]):r[a];return i.prototype=o,i.prototype.constructor=i,i.extend=arguments.callee,window.__tmClass=i,i}}(),window._c2pService=window._c2pService||[],window.triggermail={config:{eventSource:"custom_integration",encodeCookie:!1}},window.console?"undefined"==typeof window.console.debug&&(console.debug=function(){}):console={debug:function(){},error:function(){},log:function(){}},window.TM_API_HOST="api.bluecore.com/api",window.triggermail.lytics=[],triggermail.lytics.__SV=1.2,function(e){function t(){t.done||(t.done=!0,j=!0,E=!1,P.each(H,function(e){e._dom_loaded()}))}function r(){try{l.documentElement.doScroll("left")}catch(e){return void setTimeout(r,1)}t()}var i=Array.prototype,n=Object.prototype,o=i.slice,a=n.toString,s=n.hasOwnProperty,c=window.console,u=window.navigator,l=window.document,g=u.userAgent,p="triggermail.lytics",d="__mps",f="__mpa",m="__mpap",h="$set",_="$add",y="$append",v="$people_distinct_id",b="__alias",w=[d,f,m,v,b],k=!1;try{var k=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}var x="https:"==l.location.protocol?"https://":"http://",O=e&&e.__SV||0,S=k,E=!S&&g.indexOf("MSIE")==-1,P={},A=!1,C={api_host:x+TM_API_HOST,cross_subdomain_cookie:!0,cookie_name:window.triggermail.custom_cookie_name||"",loaded:function(){},store_google:!1,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,live_demo:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,ip:!0},j=!1;!function(){var e=i.forEach,t=i.indexOf,r=Array.isArray,n={},c=P.each=function(t,r,i){if(null!=t)if(e&&t.forEach===e)t.forEach(r,i);else if(t.length===+t.length){for(var o=0,a=t.length;o<a;o++)if(o in t&&r.call(i,t[o],o,t)===n)return}else for(var c in t)if(s.call(t,c)&&r.call(i,t[c],c,t)===n)return};P.addEvent=function(e,t,r,i){function n(e,t){return e?e.matches(t)?e:n(e.parentElement,t):null}if(window.jQuery)jQuery(e).on&&i?jQuery(e).on(t,i,r):jQuery(e)[t](r);else{Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector);var o;e.attachEvent?(o=e.attachEvent,t="on"+t):o=e.addEventListener;var a;a="string"==typeof e?l.querySelectorAll(e):[e];for(var s=0;s<a.length;s++)i?o.apply(a[s],[t,function(e){var t=e||window.event,o=n(t.target||t.srcElement,i);o&&r.call(o,e)}]):o.apply(a[s],[t,r.bind(a[s])])}},P.getJSON=function(e,t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(){if(r.status>=200&&r.status<400){var e=JSON.parse(r.responseText);t(e)}},r.send()},P.removeEvent=function(e,t,r){e.detachEvent?e.detachEvent("on"+t,r):e.removeEventListener(t,r)},P.extend=function(e){return c(o.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&(e[r]=t[r])}),e},P.isArray=r||function(e){return"[object Array]"===a.call(e)},P.isFunction=function(e){try{return/^\s*\bfunction\b/.test(e)}catch(e){return!1}},P.isArguments=function(e){return!(!e||!s.call(e,"callee"))},P.toArray=function(e){return e?e.toArray?e.toArray():P.isArray(e)?o.call(e):P.isArguments(e)?o.call(e):P.values(e):[]},P.values=function(e){var t=[];return null==e?t:(c(e,function(e){t[t.length]=e}),t)},P.identity=function(e){return e},P.include=function(e,r){var i=!1;return null==e?i:t&&e.indexOf===t?e.indexOf(r)!=-1:(c(e,function(e){if(i||(i=e===r))return n}),i)},P.includes=function(e,t){return e.indexOf(t)!==-1}}();var I=function(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,n){return e.call(t,r,i,n)};case 4:return function(r,i,n,o){return e.call(t,r,i,n,o)}}return function(){return e.apply(t,arguments)}},U=function(e){return function(t){return null==t?void 0:t[e]}},q=Math.pow(2,53)-1,T=U("length"),D=function(e){var t=T(e);return"number"==typeof t&&t>=0&&t<=q},N=function(e,t,r){return null==e?P.identity:P.isFunction(e)?I(e,t,r):P.isObject(e)?P.matcher(e):P.property(e)};P.map=P.collect=function(e,t,r){t=N(t,r);for(var i=!D(e)&&P.keys(e),n=(i||e).length,o=Array(n),a=0;a<n;a++){var s=i?i[a]:a;o[a]=t(e[s],s,e)}return o},P.inherit=function(e,t){return e.prototype=new t,e.prototype.constructor=e,e.superclass=t.prototype,e},P.isObject=function(e){return e===Object(e)&&!P.isArray(e)},P.isEmptyObject=function(e){if(P.isObject(e)){for(var t in e)if(s.call(e,t))return!1;return!0}return!1},P.isUndefined=function(e){return void 0===e},P.isString=function(e){return"[object String]"==a.call(e)},P.isDate=function(e){return"[object Date]"==a.call(e)},P.isNumber=function(e){return"[object Number]"==a.call(e)},P.encodeDates=function(e){return P.each(e,function(t,r){P.isDate(t)?e[r]=P.formatDate(t):P.isObject(t)&&(e[r]=P.encodeDates(t))}),e},P.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())},P.strip_empty_properties=function(e){var t={};return P.each(e,function(e,r){P.isString(e)&&e.length>0&&(t[r]=e)}),t},P.truncate=function(e,t){var r;return"string"==typeof e?r=e.slice(0,t):P.isArray(e)?(r=[],P.each(e,function(e){r.push(P.truncate(e,t))})):P.isObject(e)?(r={},P.each(e,function(e,i){r[i]=P.truncate(e,t)})):r=e,r},P.trim=function(e){return String.prototype.trim?String(e).trim():this.replace(/^\s+|\s+$/g,"")},P.JSONEncode=function(){return function(e){var t=e,r=function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=r[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},i=function(e,t){var n="",o="    ",c=0,u="",l="",g=0,p=n,d=[],f=t[e];switch(typeof f){case"string":return r(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(n+=o,d=[],"[object Array]"===a.apply(f)){for(g=f.length,c=0;c<g;c+=1)d[c]=i(c,f)||"null";return l=0===d.length?"[]":n?"[\n"+n+d.join(",\n"+n)+"\n"+p+"]":"["+d.join(",")+"]",n=p,l}for(u in f)s.call(f,u)&&(l=i(u,f),l&&d.push(r(u)+(n?": ":":")+l));return l=0===d.length?"{}":n?"{"+d.join(",")+p+"}":"{"+d.join(",")+"}",n=p,l}};return i("",{"":t})}}(),P.JSONDecode=function(){var e,t,r,i,n={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},o=function(t){throw{name:"SyntaxError",message:t,at:e,text:r}},a=function(i){return i&&i!==t&&o("Expected '"+i+"' instead of '"+t+"'"),t=r.charAt(e),e+=1,t},s=function(){var e,r="";for("-"===t&&(r="-",a("-"));t>="0"&&t<="9";)r+=t,a();if("."===t)for(r+=".";a()&&t>="0"&&t<="9";)r+=t;if("e"===t||"E"===t)for(r+=t,a(),"-"!==t&&"+"!==t||(r+=t,a());t>="0"&&t<="9";)r+=t,a();return e=+r,isFinite(e)?e:void o("Bad number")},c=function(){var e,r,i,s="";if('"'===t)for(;a();){if('"'===t)return a(),s;if("\\"===t)if(a(),"u"===t){for(i=0,r=0;r<4&&(e=parseInt(a(),16),isFinite(e));r+=1)i=16*i+e;s+=String.fromCharCode(i)}else{if("string"!=typeof n[t])break;s+=n[t]}else s+=t}o("Bad string")},u=function(){for(;t&&t<=" ";)a()},l=function(){switch(t){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null}o("Unexpected '"+t+"'")},g=function(){var e=[];if("["===t){if(a("["),u(),"]"===t)return a("]"),e;for(;t;){if(e.push(i()),u(),"]"===t)return a("]"),e;a(","),u()}}o("Bad array")},p=function(){var e,r={};if("{"===t){if(a("{"),u(),"}"===t)return a("}"),r;for(;t;){if(e=c(),u(),a(":"),Object.hasOwnProperty.call(r,e)&&o('Duplicate key "'+e+'"'),r[e]=i(),u(),"}"===t)return a("}"),r;a(","),u()}}o("Bad object")};return i=function(){switch(u(),t){case"{":return p();case"[":return g();case'"':return c();case"-":return s();default:return t>="0"&&t<="9"?s():l()}},function(n){var a;return r=n,e=0,t=" ",a=i(),u(),t&&o("Syntax error"),a}}(),P.base64Encode=function(e){var t,r,i,n,o,a,s,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,g=0,p="",d=[];if(!e)return e;e=P.utf8Encode(e);do t=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),c=t<<16|r<<8|i,n=c>>18&63,o=c>>12&63,a=c>>6&63,s=63&c,d[g++]=u.charAt(n)+u.charAt(o)+u.charAt(a)+u.charAt(s);while(l<e.length);switch(p=d.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p},P.utf8Encode=function(e){e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var t,r,i,n="",o=0;for(t=r=0,o=e.length,i=0;i<o;i++){var a=e.charCodeAt(i),s=null;a<128?r++:s=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),null!==s&&(r>t&&(n+=e.substring(t,r)),n+=s,t=r=i+1)}return r>t&&(n+=e.substring(t,e.length)),n},P.UUID=function(){var e=function(){for(var e=1*new Date,t=0;e==1*new Date;)t++;return e.toString(16)+t.toString(16)},t=function(){return Math.random().toString(16).replace(".","")},r=function(e){function t(e,t){var r,i=0;for(r=0;r<t.length;r++)i|=o[r]<<8*r;return e^i}var r,i,n=g,o=[],a=0;for(r=0;r<n.length;r++)i=n.charCodeAt(r),o.unshift(255&i),o.length>=4&&(a=t(a,o),o=[]);return o.length>0&&(a=t(a,o)),a.toString(16)};return function(){var i=(screen.height*screen.width).toString(16);return e()+"-"+t()+"-"+r()+"-"+i+"-"+e()}}(),P.isBlockedUA=function(){var e=g;return!!/(google web preview|baiduspider|yandexbot)/i.test(e)},P.HTTPBuildQuery=function(e,t){var r,i,n=[];return"undefined"==typeof t&&(t="&"),P.each(e,function(e,t){r=encodeURIComponent(e.toString()),i=encodeURIComponent(t),n[n.length]=i+"="+r}),n.join(t)},P.getQueryParam=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\?&]"+t+"=([^&#]*)",i=new RegExp(r),n=i.exec(e);return null===n||n&&"string"!=typeof n[1]&&n[1].length?"":decodeURIComponent(n[1]).replace(/\+/g," ")},P.cookie={get:function(e){for(var t=e+"=",r=l.cookie.split(";"),i=0;i<r.length;i++){for(var n=r[i];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t)){var o=n.substring(t.length,n.length);return triggermail.config.encodeCookie?P.cookie.decode(o):decodeURIComponent(o)}}return null},parse:function(e){var t;try{t=P.JSONDecode(P.cookie.get(e))||{}}catch(e){}return t},set:function(e,t,r,i){var n="",o="";if(i){var a=l.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),s=a?a[0]:"";n=s?"; domain=."+s:""}if(r){var c=new Date;c.setTime(c.getTime()+24*r*60*60*1e3),o="; expires="+c.toGMTString()}t=triggermail.config.encodeCookie?P.cookie.encode(t):encodeURIComponent(t),l.cookie=e+"="+t+o+"; path=/"+n},remove:function(e,t){P.cookie.set(e,"",-1,t)},encode:function(e){return e=P.cookie._encoder.encode(e),e=e.replace(/=/g,""),e=encodeURIComponent(e),e.replace(/%/g,"-")},decode:function(e){return/^%7B%22.*%22%7D$/.test(e)?decodeURIComponent(e):(e=e.replace(/-/g,"%"),e=decodeURIComponent(e),e=P.cookie._encoder.decode(e))},_encoder:function(){function e(e){var t,i,n,o,a,s;for(n=e.length,i=0,t="";i<n;){if(o=255&e.charCodeAt(i++),i==n){t+=r.charAt(o>>2),t+=r.charAt((3&o)<<4),t+="==";break}if(a=e.charCodeAt(i++),i==n){t+=r.charAt(o>>2),t+=r.charAt((3&o)<<4|(240&a)>>4),t+=r.charAt((15&a)<<2),t+="=";break}s=e.charCodeAt(i++),t+=r.charAt(o>>2),t+=r.charAt((3&o)<<4|(240&a)>>4),t+=r.charAt((15&a)<<2|(192&s)>>6),t+=r.charAt(63&s)}return t}function t(e){var t,r,n,o,a,s,c;for(s=e.length,a=0,c="";a<s;){do t=i[255&e.charCodeAt(a++)];while(a<s&&t==-1);if(t==-1)break;do r=i[255&e.charCodeAt(a++)];while(a<s&&r==-1);if(r==-1)break;c+=String.fromCharCode(t<<2|(48&r)>>4);do{if(n=255&e.charCodeAt(a++),61==n)return c;n=i[n]}while(a<s&&n==-1);if(n==-1)break;c+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(o=255&e.charCodeAt(a++),61==o)return c;o=i[o]}while(a<s&&o==-1);if(o==-1)break;c+=String.fromCharCode((3&n)<<6|o)}return c}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);return{encode:e,decode:t}}()},P.register_event=function(){function e(e,r,i){var n=function(n){var o=n;n=n||t(window.event);var a,s;"undefined"!=typeof n&&(s=r.call(e,n)),P.isFunction(i)&&(a=i(o));var c=!0;return!1!==a&&!1!==s||(c=!1),c};return n}function t(e){return e&&(e.preventDefault=t.preventDefault,e.stopPropagation=t.stopPropagation),e}var r=function(t,r,i,n){if(!t)return void L.error("No valid element provided to register_event");if(t.addEventListener&&!n)t.addEventListener(r,i,!1);else{var o="on"+r,a=t[o];t[o]=e(t,i,a)}};return t.preventDefault=function(){this.returnValue=!1},t.stopPropagation=function(){this.cancelBubble=!0},r}(),P.dom_query=function(){function e(e){return e.all?e.all:e.getElementsByTagName("*")}function t(e,t){var r=" "+t+" ";return(" "+e.className+" ").replace(i," ").indexOf(r)>=0}function r(r){if(!l.getElementsByTagName)return new Array;for(var i,n=r.split(" "),o=new Array(l),a=0;a<n.length;a++)if(i=n[a].replace(/^\s+/,"").replace(/\s+$/,""),i.indexOf("#")>-1){var s=i.split("#"),c=s[0],u=s[1],g=l.getElementById(u);if(!g||c&&g.nodeName.toLowerCase()!=c)return new Array;o=new Array(g)}else if(i.indexOf(".")>-1){var s=i.split("."),c=s[0],p=s[1];c||(c="*");for(var d=new Array,f=0,m=0;m<o.length;m++){var h;h="*"==c?e(o[m]):o[m].getElementsByTagName(c);for(var _=0;_<h.length;_++)d[f++]=h[_]}o=new Array;for(var y=0,v=0;v<d.length;v++)d[v].className&&P.isString(d[v].className)&&t(d[v],p)&&(o[y++]=d[v])}else if(i.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var c=RegExp.$1,b=RegExp.$2,w=RegExp.$3,k=RegExp.$4;c||(c="*");for(var d=new Array,f=0,m=0;m<o.length;m++){var h;h="*"==c?e(o[m]):o[m].getElementsByTagName(c);for(var _=0;_<h.length;_++)d[f++]=h[_]}o=new Array;var x,y=0;switch(w){case"=":x=function(e){return e.getAttribute(b)==k};break;case"~":x=function(e){return e.getAttribute(b).match(new RegExp("\\b"+k+"\\b"))};break;case"|":x=function(e){return e.getAttribute(b).match(new RegExp("^"+k+"-?"))};break;case"^":x=function(e){return 0==e.getAttribute(b).indexOf(k)};break;case"$":x=function(e){return e.getAttribute(b).lastIndexOf(k)==e.getAttribute(b).length-k.length};break;case"*":x=function(e){return e.getAttribute(b).indexOf(k)>-1};break;default:x=function(e){return e.getAttribute(b)}}o=new Array,y=0;for(var v=0;v<d.length;v++)x(d[v])&&(o[y++]=d[v])}else{c=i;for(var d=new Array,f=0,m=0;m<o.length;m++)for(var h=o[m].getElementsByTagName(c),_=0;_<h.length;_++)d[f++]=h[_];o=d}return o}var i=/[\t\r\n]/g;return r}(),P.info={campaignParams:function(){var e="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),t="",r={};return P.each(e,function(e){t=P.getQueryParam(l.URL,e),t.length&&(r[e]=t)}),r},searchEngine:function(e){return 0===e.search("https?://(.*)google.([^/?]*)")?"google":0===e.search("https?://(.*)bing.com")?"bing":0===e.search("https?://(.*)yahoo.com")?"yahoo":0===e.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(e){var t=P.info.searchEngine(e),r="yahoo"!=t?"q":"p",i={};if(null!==t){i.g_search_engine=t;var n=P.getQueryParam(e,r);n.length&&(i.mp_keyword=n)}return i},browser:function(){var e=g,t=u.vendor||"";return window.opera?P.includes(e,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":P.includes(e,"Chrome")?"Chrome":P.includes(t,"Apple")?P.includes(e,"Mobile")?"Mobile Safari":"Safari":P.includes(e,"Android")?"Android Mobile":P.includes(e,"Konqueror")?"Konqueror":P.includes(e,"Firefox")?"Firefox":P.includes(e,"MSIE")?"Internet Explorer":P.includes(e,"Gecko")?"Mozilla":""},os:function(){var e=g;return/Windows/i.test(e)?/Phone/.test(e)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(e)?"iOS":/Android/.test(e)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Mac/i.test(e)?"Mac OS X":/Linux/.test(e)?"Linux":""},device:function(){var e=g;return/iPhone/.test(e)?"iPhone":/iPad/.test(e)?"iPad":/iPod/.test(e)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(e)?"BlackBerry":/Windows Phone/i.test(e)?"Windows Phone":/Android/.test(e)?"Android":""},referringDomain:function(e){var t=e.split("/");return t.length>=3?t[2]:""},properties:function(){return P.strip_empty_properties({os:P.info.os(),browser:P.info.browser(),device:P.info.device(),mp_lib:"web"})},people_properties:function(){return P.strip_empty_properties({$os:P.info.os(),$browser:P.info.browser()})},pageviewInfo:function(e){return P.strip_empty_properties({mp_page:e,mp_referrer:l.referrer,mp_browser:P.info.browser(),mp_platform:P.info.os()})}};var L={log:function(){if((A||triggermail.util.cookie.get("_bc_platform_debug"))&&!P.isUndefined(c)&&c)try{c.log.apply(c,arguments)}catch(e){P.each(arguments,function(e){c.log(e)})}},error:function(){if((A||triggermail.util.cookie.get("_bc_platform_debug"))&&!P.isUndefined(c)&&c){var e=["Bluecore error:"].concat(P.toArray(arguments));try{c.error.apply(c,e)}catch(t){P.each(e,function(e){c.error(e)})}}},critical:function(){if(!P.isUndefined(c)&&c){var e=["Bluecore error:"].concat(P.toArray(arguments));try{c.error.apply(c,e)}catch(t){P.each(e,function(e){c.error(e)})}}}},R=function(){};R.prototype.create_properties=function(){},R.prototype.event_handler=function(){},R.prototype.after_track_handler=function(){},R.prototype.init=function(e){return this.mp=e,this},R.prototype.track=function(e,t,r,i){var n=this,o=P.dom_query(e);return 0==o.length?void L.error("The DOM query ("+e+") returned 0 elements"):(P.each(o,function(e){P.register_event(e,this.override_event,function(e){var o={},a=n.create_properties(r,this),s=n.mp.get_config("track_links_timeout");n.event_handler(e,this,o),window.setTimeout(n.track_callback(i,a,o,!0),s),n.mp.track(t,a,n.track_callback(i,a,o))})},this),!0)},R.prototype.track_callback=function(e,t,r,i){i=i||!1;var n=this;return function(){r.callback_fired||(r.callback_fired=!0,e&&e(i,t)===!1||n.after_track_handler(t,r,i))}},R.prototype.create_properties=function(e,t){var r;return r="function"==typeof e?e(t):P.extend({},e)};var M=function(){this.override_event="click"};P.inherit(M,R),M.prototype.create_properties=function(e,t){var r=M.superclass.create_properties.apply(this,arguments);return t.href&&(r.url=t.href),r},M.prototype.event_handler=function(e,t,r){r.new_tab=2===e.which||e.metaKey||"_blank"===t.target,r.href=t.href,r.new_tab||e.preventDefault()},M.prototype.after_track_handler=function(e,t,r){t.new_tab||setTimeout(function(){window.location=t.href},0)};var z=function(){this.override_event="submit"};P.inherit(z,R),z.prototype.event_handler=function(e,t,r){r.element=t,e.preventDefault()},z.prototype.after_track_handler=function(e,t,r){setTimeout(function(){t.element.submit()},0)};var Q=function(e){this.props={},this.campaign_params_saved=!1,e.cookie_name?this.name="mp_"+e.cookie_name:this.name="mp_"+e.token+"_mixpanel",this.load(),this.update_config(e),this.upgrade(e),this.save()};Q.prototype.properties=function(){var e={};return P.each(this.props,function(t,r){P.include(w,r)||(e[r]=t)}),e},Q.prototype.load=function(){if(!this.disabled){var e=P.cookie.parse(this.name);e&&(this.props=P.extend({},e))}},Q.prototype.upgrade=function(e){var t,r,i=e.upgrade;i&&(t="mp_super_properties","string"==typeof i&&(t=i),r=P.cookie.parse(t),P.cookie.remove(t),P.cookie.remove(t,!0),r&&(this.props=P.extend(this.props,r.all,r.events))),e.cookie_name||"mixpanel"===e.name||(t="mp_"+e.token+"_"+e.name,r=P.cookie.parse(t),r&&(P.cookie.remove(t),P.cookie.remove(t,!0),this.register_once(r)))},Q.prototype.save=function(){this.disabled||P.cookie.set(this.name,P.JSONEncode(this.props),this.expire_days,this.cross_subdomain)},Q.prototype.remove=function(){P.cookie.remove(this.name,!1),P.cookie.remove(this.name,!0)},Q.prototype.clear=function(){this.remove(),this.props={}},Q.prototype.register_once=function(e,t,r){return!!P.isObject(e)&&("undefined"==typeof t&&(t="None"),this.expire_days="undefined"==typeof r?this.default_expiry:r,P.each(e,function(e,r){this.props[r]&&this.props[r]!==t||(this.props[r]=e)},this),this.save(),!0)},Q.prototype.register=function(e,t){return!!P.isObject(e)&&(this.expire_days="undefined"==typeof t?this.default_expiry:t,P.extend(this.props,e),this.save(),!0)},Q.prototype.unregister=function(e){e in this.props&&(delete this.props[e],this.save())},Q.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(P.info.campaignParams()),this.campaign_params_saved=!0)},Q.prototype.update_search_keyword=function(e){this.register(P.info.searchInfo(e))},Q.prototype.update_referrer_info=function(e){this.register_once({$initial_referrer:e||"$direct",$initial_referring_domain:P.info.referringDomain(e)||"$direct"},"")},Q.prototype.get_referrer_info=function(){return P.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})},Q.prototype.safe_merge=function(e){return P.each(this.props,function(t,r){r in e||(e[r]=t)}),e},Q.prototype.update_config=function(e){this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_cookie),this.set_cross_subdomain(e.cross_subdomain_cookie)},Q.prototype.set_disabled=function(e){this.disabled=e,this.disabled&&this.remove()},Q.prototype.set_cross_subdomain=function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())},Q.prototype.get_cross_subdomain=function(){return this.cross_subdomain},Q.prototype._add_to_people_queue=function(e,t){var r=this._get_queue_key(e),i=t[e],n=this._get_or_create_queue(h),o=this._get_or_create_queue(_),a=this._get_or_create_queue(y,[]);r===d?(P.extend(n,i),this._pop_from_people_queue(_,i)):r===f?P.each(i,function(e,t){t in n?n[t]+=e:(t in o||(o[t]=0),o[t]+=e)},this):r===m&&a.push(i),L.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):"),L.log(t),this.save()},Q.prototype._pop_from_people_queue=function(e,t){var r=this._get_queue(e);P.isUndefined(r)||(P.each(t,function(e,t){delete r[t]},this),this.save())},Q.prototype._get_queue_key=function(e){return e===h?d:e===_?f:e===y?m:void L.error("Invalid queue:",e)},Q.prototype._get_queue=function(e){return this.props[this._get_queue_key(e)]},Q.prototype._get_or_create_queue=function(e,t){var r=this._get_queue_key(e),t=P.isUndefined(t)?{}:t;return this.props[r]||(this.props[r]=t)};var B=function(t,r,i){var n,o=i===p?e:e[i];return o&&!P.isArray(o)?void L.error("You have already initialized "+i):(n=new $,n._init(t,r,i),n.people=new F,n.people._init(n),A=A||n.get_config("debug"),P.isUndefined(o)||(n._execute_array.call(n.people,o.people),n._execute_array(o)),n)},$=function(){};$.prototype.init=function(t,r,i){if("undefined"==typeof i)return void L.error("You must name your new library: init(token, config, name)");if(i===p)return void L.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");var n=B(t,r,i);return e[i]=n,n._loaded(),n},$.prototype._init=function(e,t,r){this.__loaded=!0,this.config={},this.set_config(P.extend({},C,t,{name:r,token:e,callback_fn:(r===p?r:"triggermail.lytics."+r)+"._jsc"})),this._jsc=function(){},this.__dom_loaded_queue=[],this.__request_queue=[],this.__disabled_events=[],this._flags={disable_all_events:!1,identify_called:!1},this.cookie=new Q(this.config),this.register_once({distinct_id:P.UUID()},"")},$.prototype._loaded=function(){this.get_config("loaded")(this),this.get_config("track_pageview")&&this.track_pageview()},$.prototype._dom_loaded=function(){P.each(this.__dom_loaded_queue,function(e){this._track_dom.apply(this,e)},this),P.each(this.__request_queue,function(e){this._send_request.apply(this,e)},this),delete this.__dom_loaded_queue,delete this.__request_queue},$.prototype._track_dom=function(e,t){if(this.get_config("img"))return L.error("You can't use DOM tracking functions with img = true."),!1;if(!j)return this.__dom_loaded_queue.push([e,t]),!1;var r=(new e).init(this);return r.track.apply(r,t)},$.prototype._prepare_callback=function(e,t){if(P.isUndefined(e))return null;if(S){var r=function(r){e(r,t)};return r}var i=this._jsc,n=""+Math.floor(1e8*Math.random()),o=this.get_config("callback_fn")+'["'+n+'"]';return i[n]=function(r){delete i[n],e(r,t)},o},$.prototype._send_request=function(e,t,r){if(E)return void this.__request_queue.push(arguments);var i=this.get_config("verbose");if(this.get_config("test")&&(t.test=1),i&&(t.verbose=1),this.get_config("img")&&(t.img=1),r&&!S&&(t.callback=r),t.ip=this.get_config("ip")?1:0,t._=(new Date).getTime().toString(),"img"in t){var n=l.createElement("img");n.src=e,l.body.appendChild(n)}else if(S){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.withCredentials=!0,o.onreadystatechange=function(e){if(4===o.readyState)if(200===o.status||202===o.status)r&&r(i?P.JSONDecode(o.responseText):Number(o.responseText));else{var t="Bad HTTP status: "+o.status+" "+o.statusText;L.error(t),r&&r(i?{status:0,error:t}:0)}},o.send(P.HTTPBuildQuery(t))}else{e+="?"+P.HTTPBuildQuery(t);var a=l.createElement("script");a.type="text/javascript",a.async=!0,a.defer=!0,a.src=e;var s=l.getElementsByTagName("script")[0];s.parentNode.insertBefore(a,s)}},$.prototype._execute_array=function(e){var t,r=[],i=[],n=[];P.each(e,function(e){e&&(t=e[0],"function"==typeof e?e.call(this):P.isArray(e)&&"alias"===t?r.push(e):P.isArray(e)&&t.indexOf("track")!=-1&&"function"==typeof this[t]?n.push(e):i.push(e))},this);var o=function(e,t){P.each(e,function(e){this[e[0]].apply(this,e.slice(1))},t)};o(r,this),o(i,this),o(n,this)},$.prototype.push=function(e){this._execute_array([e])},$.prototype.disable=function(e){"undefined"==typeof e?this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(e)},$.prototype.track=function(e,t,r,i){if("undefined"==typeof e)return void L.error("No event name provided to mixpanel.track");t=t||{},t.token=t.token||this.get_config("token"),triggermail.config.eventSource&&!t.event_source&&(t.event_source=triggermail.config.eventSource),this.cookie.update_search_keyword(l.referrer),this.get_config("store_google")&&this.cookie.update_campaign_params(),this.get_config("save_referrer")&&this.cookie.update_referrer_info(l.referrer),t=P.extend({},P.info.properties(),this.cookie.properties(),t),t.distinct_id=i||t.distinct_id;for(var n=["ch","bc_persist_updated"],o=0;o<n.length;o++)delete t[n[o]];var a=triggermail.util.strip_props_before_send||function(e){return e};a(t);var s={event:e,properties:t};A&&(s.validate=1);var c=P.truncate(s,1023),u=P.JSONEncode(c),g=P.base64Encode(u);L.log("BLUECORE REQUEST:"),L.log(c);var p=g;return payload={data:p},this.get_distinct_id().indexOf("live_demo")!=-1?(payload.live_demo=!0,track_path=this.get_config("api_host")+"/templates/demo_track/"+e):this.get_distinct_id().indexOf("event_stream")!=-1?(payload.event_stream=!0,track_path=this.get_config("api_host")+"/templates/event_stream_track/"+e):track_path=this.get_config("api_host")+"/track/"+e,this._send_request(track_path,payload,this._prepare_callback(r,c)),c},$.prototype.track_pageview=function(e){"undefined"==typeof e&&(e=l.location.href),this.track("mp_page_view",P.info.pageviewInfo(e))},$.prototype.track_links=function(){return this._track_dom.call(this,M,arguments)},$.prototype.track_forms=function(){return this._track_dom.call(this,z,arguments)},$.prototype.register=function(e,t){this.cookie.register(e,t)},$.prototype.register_once=function(e,t,r){this.cookie.register_once(e,t,r)},$.prototype.unregister=function(e){this.cookie.unregister(e)},$.prototype._register_single=function(e,t){var r={};r[e]=t,this.register(r)},$.prototype.identify=function(e,t,r,i){e!=this.get_distinct_id()&&e!=this.get_property(b)&&(this.unregister(b),this._register_single("distinct_id",e)),this._flags.identify_called=!0,this.people._flush(t,r,i)},$.prototype.get_distinct_id=function(){return this.get_property("distinct_id")},$.prototype.alias=function(e,t){if(e===this.get_property(v))return L.critical("Attempting to create alias for existing People user - aborting."),-2;var r=this;return P.isUndefined(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(b,e),this.track("$create_alias",{alias:e,distinct_id:t},function(t){r.identify(e)})):(L.error("alias matches current distinct_id - skipping api call."),this.identify(e),-1)},$.prototype.name_tag=function(e){this._register_single("mp_name_tag",e)},$.prototype.set_config=function(e){P.isObject(e)&&(P.extend(this.config,e),this.cookie&&this.cookie.update_config(this.config),A=A||this.get_config("debug"))},$.prototype.get_config=function(e){return this.config[e]},$.prototype.get_property=function(e){return this.cookie.props[e]},$.prototype.toString=function(){var e=this.get_config("name");return e!==p&&(e="triggermail.lytics."+e),e};var F=function(){};if(F.prototype._init=function(e){this._mixpanel=e},F.prototype.set=function(e,t,r){var i={},n={};return P.isObject(e)?(P.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(n[t]=e)}),r=t):n[e]=t,this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(l.referrer),n=P.extend({},P.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),n),i[h]=n,this._send_request(i,r)},F.prototype.increment=function(e,t,r){var i={},n={};return P.isObject(e)?(P.each(e,function(e,t){if("$distinct_id"!=t&&"$token"!=t)return isNaN(parseFloat(e))?void L.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):void(n[t]=e)}),r=t):(P.isUndefined(t)&&(t=1),n[e]=t),i[_]=n,this._send_request(i,r)},F.prototype.append=function(e,t,r){var i={},n={};return P.isObject(e)?(P.each(e,function(e,t){"$distinct_id"!=t&&"$token"!=t&&(n[t]=e)}),r=t):n[e]=t,i[y]=n,this._send_request(i,r)},F.prototype.track_charge=function(e,t,r){return!P.isNumber(e)&&(e=parseFloat(e),isNaN(e))?void L.error("Invalid value passed to mixpanel.people.track_charge - must be a number"):this.append("$transactions",P.extend({$amount:e},t),r)},F.prototype.clear_charges=function(e){return this.set("$transactions",[],e)},F.prototype.delete_user=function(){if(!this._identify_called())return void L.error("mixpanel.people.delete_user() requires you to call identify() first");var e={$delete:this._mixpanel.get_distinct_id()};return this._send_request(e)},F.prototype.toString=function(){return this._mixpanel.toString()+".people"},F.prototype._send_request=function(e,t){e.$token=this._get_config("token"),e.$distinct_id=this._mixpanel.get_distinct_id();var r=P.encodeDates(e),i=P.truncate(r,255),n=P.JSONEncode(r),o=P.base64Encode(n);return this._identify_called()?(L.log("BLUECORE PEOPLE REQUEST:"),L.log(i),this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:o},this._mixpanel._prepare_callback(t,i)),i):(this._enqueue(e),P.isUndefined(t)||t(this._get_config("verbose")?{status:-1,error:null}:-1),i)},F.prototype._get_config=function(e){return this._mixpanel.get_config(e)},F.prototype._identify_called=function(){return this._mixpanel._flags.identify_called===!0},F.prototype._enqueue=function(e){h in e?this._mixpanel.cookie._add_to_people_queue(h,e):_ in e?this._mixpanel.cookie._add_to_people_queue(_,e):y in e?this._mixpanel.cookie._add_to_people_queue(y,e):L.error("Invalid call to _enqueue():",e);
},F.prototype._flush=function(e,t,r){var i=this,n=P.extend({},this._mixpanel.cookie._get_queue(h)),o=P.extend({},this._mixpanel.cookie._get_queue(_)),a=this._mixpanel.cookie._get_queue(y);if(P.isUndefined(n)||!P.isObject(n)||P.isEmptyObject(n)||(i._mixpanel.cookie._pop_from_people_queue(h,n),this.set(n,function(t,r){0==t&&i._mixpanel.cookie._add_to_people_queue(h,n),P.isUndefined(e)||e(t,r)})),P.isUndefined(o)||!P.isObject(o)||P.isEmptyObject(o)||(i._mixpanel.cookie._pop_from_people_queue(_,o),this.increment(o,function(e,r){0==e&&i._mixpanel.cookie._add_to_people_queue(_,o),P.isUndefined(t)||t(e,r)})),!P.isUndefined(a)&&P.isArray(a)&&a.length)for(var s=a.length-1;s>=0;s--){var c=a.pop();i.append(c,function(e,t){0==e&&i._mixpanel.cookie._add_to_people_queue(y,c),P.isUndefined(r)||r(e,t)})}},P.toArray=P.toArray,P.isObject=P.isObject,P.JSONEncode=P.JSONEncode,P.JSONDecode=P.JSONDecode,P.isEmptyObject=P.isEmptyObject,$.prototype.init=$.prototype.init,$.prototype.disable=$.prototype.disable,$.prototype.track=$.prototype.track,$.prototype.track_links=$.prototype.track_links,$.prototype.track_forms=$.prototype.track_forms,$.prototype.track_pageview=$.prototype.track_pageview,$.prototype.register=$.prototype.register,$.prototype.register_once=$.prototype.register_once,$.prototype.unregister=$.prototype.unregister,$.prototype.identify=$.prototype.identify,$.prototype.alias=$.prototype.alias,$.prototype.name_tag=$.prototype.name_tag,$.prototype.set_config=$.prototype.set_config,$.prototype.get_config=$.prototype.get_config,$.prototype.get_property=$.prototype.get_property,$.prototype.get_distinct_id=$.prototype.get_distinct_id,$.prototype.toString=$.prototype.toString,Q.prototype.properties=Q.prototype.properties,Q.prototype.update_search_keyword=Q.prototype.update_search_keyword,Q.prototype.update_referrer_info=Q.prototype.update_referrer_info,Q.prototype.get_cross_subdomain=Q.prototype.get_cross_subdomain,Q.prototype.clear=Q.prototype.clear,F.prototype.set=F.prototype.set,F.prototype.increment=F.prototype.increment,F.prototype.append=F.prototype.append,F.prototype.track_charge=F.prototype.track_charge,F.prototype.clear_charges=F.prototype.clear_charges,F.prototype.delete_user=F.prototype.delete_user,F.prototype.toString=F.prototype.toString,P.isUndefined(e))return void L.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");if(e.__loaded||e.config&&e.cookie)return void L.error("Mixpanel library has already been downloaded at least once.");if(O<1.1)return void L.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");var H={};P.each(e._i,function(e){var t,r;e&&P.isArray(e)&&(t=e[e.length-1],r=B.apply(this,e),H[t]=r)});var J=function(){P.each(H,function(t,r){r!==p&&(e[r]=t)}),e._=P};if(e.init=function(t,r,i){if(i)e[i]||(e[i]=H[i]=B(t,r,i),e[i]._loaded());else{var n=e;H[p]?n=H[p]:t&&(n=B(t,r,p)),window[p]=e=n,J()}},e.init(),P.each(H,function(e){e._loaded()}),l.addEventListener)"complete"==l.readyState?t():l.addEventListener("DOMContentLoaded",t,!1);else if(l.attachEvent){l.attachEvent("onreadystatechange",t);var V=!1;try{V=null==window.frameElement}catch(e){}l.documentElement.doScroll&&V&&r()}P.register_event(window,"load",t,!0)}(window.triggermail.lytics),function(){function e(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}e(triggermail,function(){var e="add_to_cart",t="browse_category",r="checkout_start",i="customer_patch",n="exception",o="identify",a="merge",s="optin",c="page_view",u="patch",l="purchase",g="remove_from_cart",p="resubscribe",d="search",f="stop",m="unsubscribe",h="viewed_cart",_="viewed_content",y="viewed_product",v="wishlist",b="email",w="obem",k="bc_id",x="coom",O=function(e,t){var r=e[w];if("undefined"!=typeof r&&""!==r){var i=triggermail.lytics.get_property(w);"undefined"==typeof i&&(triggermail.persist.write_prop(w,r),triggermail.track(o,{customer:e}))}var n=e[b],a=e[x];if((void 0!==n&&""!==n||a)&&(t===!0||(n=triggermail.core.sanitizer.sanitize("email",n)))){var s=triggermail.util.hashCode(n||a);return s!==triggermail.persist.read_prop(k)&&(triggermail.persist.write_prop(k,s),triggermail.track(o,{customer:e})),e}};return{EMAIL_ADDRESS_PROPERTY:"email_address",PAGE_VIEW:"page_view",MAX_PROPERTY_LENGTH:1024,track:function(e,t,r){var i=triggermail.lytics._.extend({},t),n=triggermail.persist.props();triggermail.lytics._.extend(t,n);try{t.url=window.location.href.slice(0,899),t.url.indexOf("s.thebrighttag")>-1&&delete t.url}catch(e){}if(e==m||e==s||e==p){if(!i.email)return;t.email=i.email}try{t.integration_version=1565097706}catch(e){}e!==c&&triggermail.lytics.track(e,t,void 0,r),triggermail.lytics.get_distinct_id()&&(t.distinct_id=triggermail.lytics.get_distinct_id());try{triggermail.integ.debug===!0&&console.debug(e,t)}catch(e){}},add_to_cart:function(t){return this.track(e,{products:[t]})},remove_from_cart:function(e){return this.track(g,{products:[e]})},wishlist:function(e){return this.track(v,{products:[e]})},view_cart:function(e){return this.track(h,e)},stop:function(e){return this.track(f,e)},page:function(e){return this.track(c,e)},purchase:function(e){var t=triggermail.lytics._.extend({},e);return triggermail.util.isValidEmail(t.email)||(t.distinct_id=triggermail.lytics.get_distinct_id(),delete t.email),this.track(l,t)},checkout_start:function(e){return this.track(r,e)},view:function(e,t){triggermail.integ.salt_products&&(e.salt=Math.random().toString(36).replace(".",""));var r=triggermail.lytics._.extend(t||{},{products:[e]});return this.track(y,r)},view_content:function(e,t){triggermail.integ.salt_products&&(e.salt=Math.random().toString(36).replace(".",""));var r=triggermail.lytics._.extend(t||{},{contents:[e]});return this.track(_,r)},search:function(e){return this.track(d,e)},browse_category:function(e){return this.track(t,{browse_properties:e})},identify:function(e,t){return O(e,t)},subscribe:function(e){return e.source="newsletter",O(e)},unsubscribe:function(e){return this.track(m,e)},resubscribe:function(e){return this.track(p,e)},optin:function(e){return this.track(s,e)},customer_patch:function(e){return this.track(i,{customer:e})},patch:function(e){return this.track(u,e)},merge:function(e){return this.track(a,e)},custom:function(e,t){return this.track(e,t)},init:function(e){},exception:function(e){var t={};triggermail.lytics._.extend(t,triggermail.lytics._.info.properties());try{t.url=window.location.href,t.url.indexOf("s.thebrighttag")>-1&&delete t.url,t.message=e.message}catch(e){}t.error=e,this.track(n,t)},anonymous_track:function(e,t,r){var i=r||triggermail.lytics._.UUID();return this.track(e,t,i),i}}}())}(),triggermail.identifySource=function(){return{ACCOUNT_REGISTER:"account register",ACCOUNT_LOGIN:"account login",EMAIL_CAPTURE_POPUP:"email capture popup",EMAIL_SIGNUP:"email signup",SITE_VARIABLE:"site variable",CHECKOUT_FLOW:"checkout flow",CUSTOM:"custom",ESP_EMAIL_APPEND:"esp email append",OBEM_EMAIL_APPEND:"obem email append",JUSTUNO:"justuno",BLUECORE_PURCHASE_PIXEL:"bluecore purchase pixel"}}(),triggermail.util=function(){return{price:function(e){var t=String(e).replace(/[^0-9\.]/g,"").split("."),r=t[0],i=(t[1]||"").slice(0,2),n=r+"."+i;return parseFloat(n)},unique:function(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return triggermail.lytics._.map(t,function(e,t){return t})},slugify:function(e){return e.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},serializeForm:function(e){var t={},r=e.serializeArray();return $.each(r,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t},getUrlParam:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",r=new RegExp(t),i=r.exec(window.location.search);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},isMobile:function(){var e=!1,t=["iphone","ipad","android","blackberry","nokia","opera mini","windows mobile","windows phone","iemobile"];for(var r in t)navigator.userAgent.toLowerCase().indexOf(t[r].toLowerCase())>0&&(e=!0);return e},getParamFromQueryString:function(e,t){return decodeURI((RegExp(t+"=(.+?)(&|$)").exec(e)||[,null])[1])},trimString:function(e,t){var r=triggermail.lytics._.trim(e).substring(0,t);return r},htmlToText:function(e){var t=document.createElement("p");return t.innerHTML=e,t.textContent||t.innerText||""},isAnonymousUser:function(){var e=triggermail.lytics.get_property(triggermail.core.EMAIL_ADDRESS_PROPERTY);return!this.isValidEmail(e)},emRegex:/\S+@\S+\.\S+/,isValidEmail:function(e){return triggermail.util.emRegex.test(e)},validateAndIdentify:function(e,t,r){var i=(e||"").trim();this.isValidEmail(i)&&triggermail.identify({email:i,source:t,source_detail:r})},findEmail:function(e,t){try{return"undefined"==typeof t&&(t=triggermail.util.emRegex),t.exec(e).pop()}catch(e){}},hashCode:function(e){var t,r,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)r=e.charCodeAt(t),i=(i<<5)-i+r,i&=i;return i},productHash:function(e){var t=this.sanitizeProductName(e[TriggerMail.PRODUCT_NAME_PROPERTY]);return this.hashCode(t)},_getbyte64:function(e,t){_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=_ALPHA.indexOf(e.charAt(t));if(r===-1)throw"Cannot decode base64";return r},b64decode:function(e){var t,r,i="=",n=0,o=e.length,a=[];if(e=String(e),0===o)return e;if(o%4!==0)throw"Cannot decode base64";for(e.charAt(o-1)===i&&(n=1,e.charAt(o-2)===i&&(n=2),o-=4),t=0;t<o;t+=4)r=this._getbyte64(e,t)<<18|this._getbyte64(e,t+1)<<12|this._getbyte64(e,t+2)<<6|this._getbyte64(e,t+3),a.push(String.fromCharCode(r>>16,r>>8&255,255&r));switch(n){case 1:r=this._getbyte64(e,t)<<18|this._getbyte64(e,t+1)<<12|this._getbyte64(e,t+2)<<6,a.push(String.fromCharCode(r>>16,r>>8&255));break;case 2:r=this._getbyte64(e,t)<<18|this._getbyte64(e,t+1)<<12,a.push(String.fromCharCode(r>>16))}return a.join("")},wrapEvent:function(e){var t=Array.prototype.slice.call(arguments,1);return function(){try{return e.apply(this,t.concat(Array.prototype.slice.call(arguments,0)))}catch(e){triggermail.exception(e)}}},removeURLParam:function(e,t){return triggermail.util.updateURLParams(e,t,!1)},keepURLParam:function(e,t){return triggermail.util.updateURLParams(e,t,!0)},updateURLParams:function(e,t,r){var i,n=e.split("?")[0],o=[],a=e.indexOf("?")!==-1?e.split("?")[1]:"";if(""!==a){o=a.split("&");for(var s=o.length-1;s>=0;s-=1)i=o[s].split("=")[0],r?triggermail.lytics._.isArray(t)?t.indexOf(i)===-1&&o.splice(s,1):i!==t&&o.splice(s,1):triggermail.lytics._.isArray(t)?t.indexOf(i)>-1&&o.splice(s,1):i===t&&o.splice(s,1);n+=o.length>0?"?"+o.join("&"):""}return n},getArrayElementFromQueryString:function(e,t){var r=[];e||(e=location.href),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");for(var i=t+"=([^&#]+)",n=new RegExp(i,"ig");;){var o=n.exec(e);if(!o||!o[1])break;r.push(o[1])}return r.length?1===r.length?r[0]:r:null},executeOnLoad:function(e,t,r,i,n,o){var a="undefined"==typeof r?3:r,s=i||500,c=n||!1,u=o||function(){},l=function(e,t){try{var r=t.shift();if("undefined"!=typeof e[r]&&e[r])return t.length>0?l(e[r],t):e[r]}catch(e){}return null};if(c&&triggermail.lytics._.dom_query(e).length>0||l(window,e.split(".")))try{t()}catch(e){}else if(a>0)try{a-=1,setTimeout(function(){triggermail.util.wrapEvent(function(){triggermail.util.executeOnLoad(e,t,a,i,c)},e,t,a,s,c)()},s)}catch(e){}else try{u()}catch(e){}},sanitizeSearchTerm:function(e){return e.replace(/[^a-z\d\s:]+/gi,"")},registerAndMergeOpaqueId:function(e){var t="tm_merged";if("undefined"!=typeof e&&e){var r=triggermail.persist.read_prop(t);if(!r){var i=triggermail.persist.read_prop("distinct_id");triggermail.track("merge",{merge:{source:i,destination:e}}),triggermail.persist.write_prop(t,!0),triggermail.persist.write_prop("distinct_id",e)}}},cookie:triggermail.lytics._.cookie,encode:triggermail.lytics._.JSONEncode,decode:triggermail.lytics._.JSONDecode,walk:function(e,t){var r=e;for(t(r),r=r.firstChild;r;)walk(e,t),r=r.nextSibling},walkUntil:function(e,t,r){var i=e;if(ret=t(i),r(ret)===!0)return ret;for(i=i.firstChild;i;)walk(i,t),i=i.nextSibling}}}(),triggermail.demo=function(){var e=triggermail.lytics.get_distinct_id();e.indexOf("live_demo")===-1&&(triggermail.lytics._register_single("distinct_id","live_demo_"+e),e=triggermail.lytics.get_distinct_id()),triggermail.lytics.cookie.update_config({live_demo:!0,cookie_expiration:1});var t=triggermail.Partner.keys.lytics.p,r="http://www.bluecore.com/api/templates/live_demo/"+t+"/"+e;window.open(r)},triggermail.event_stream=function(){var e=triggermail.lytics.get_distinct_id();e.indexOf("event_stream")===-1&&(triggermail.lytics._register_single("distinct_id","event_stream_"+e),e=triggermail.lytics.get_distinct_id()),triggermail.lytics.cookie.update_config({event_stream:!0,cookie_expiration:1});var t=triggermail.Partner.keys.lytics.p,r="http://www.bluecore.com/api/templates/event_stream/"+t+"/"+e;window.open(r)},triggermail.insanetiego=function(){return{inject_div:function(){$("body").append('<div id="insanetiego" style="position:fixed;bottom:0;width:100%;background:#D8E7ED;height:300px;overflow:scroll;z-index:2000;border-top-style:solid;border-top-width:5px;"></div>')},remove_div:function(){$("#insanetiego").remove()},debug:function(){triggermail.util.cookie.set("tm_debug",!0),triggermail.integ.debug=!0,this.inject_div()},undebug:function(){triggermail.util.cookie.set("tm_debug",!1),triggermail.integ.debug=!1}}}(),triggermail.core={},triggermail.core.sanitizer=function(){function e(e){return""}function t(e){return r(e)?e:null}function r(e){var t=/\S+@\S+\.\S+/;return t.test(e)}return{sanitize:function(r,i){return"email"===r?t(i):i?i:e(r)}}}(),triggermail.persist=function(){var e="COOKIE_ONLY",t="LOCAL_STORAGE",r="bc_persist_props",i="bc_id",n="distinct_id",o="email",a="bc_persist_updated",s=t,c=function(r){return r===e||r===t},u=function(){return triggermail.lytics.cookie.props||{}},l=function(){return JSON.parse(localStorage.getItem(r))||{}},g=function(e){try{var t=e[o];if(t){var r=triggermail.lytics._.extend({},e);return delete r[o],r[i]=triggermail.util.hashCode(t),r}}catch(e){}return e},p=function(){var e=Date.now();m(a,e);var t=u();t=g(t),localStorage.setItem(r,JSON.stringify(t))},d=function(e,t){var r=e.distinct_id;try{t[n]&&t[n]!==r&&triggermail.track("merge",{merge:{source:t[n],destination:r}}),t[o]&&triggermail.util.isValidEmail(t[o])&&triggermail.track("merge",{merge:{source:t[o],destination:r}})}catch(e){}},f=function(e,t,i){var o={},s=Date.now(),c=i?e:t,u=i?t:e;o=triggermail.lytics._.extend(o,c),o=triggermail.lytics._.extend(o,u),o=g(o),o[a]=s,o[n]=e[n],triggermail.lytics.cookie.props=o,triggermail.lytics.cookie.save(),localStorage.setItem(r,JSON.stringify(o))},m=function(e,t){triggermail.lytics.cookie.props[e]=t,triggermail.lytics.cookie.save()},h=function(e,t){var i=JSON.parse(localStorage.getItem(r));i[e]=t,i=g(i),i[a]=Date.now(),localStorage.setItem(r,JSON.stringify(i))},_=function(e){delete triggermail.lytics.cookie.props[e],triggermail.lytics.cookie.save()},y=function(e){var t=JSON.parse(localStorage.getItem(r));delete t[e],t[a]=Date.now(),localStorage.setItem(r,JSON.stringify(t))};return{setMode:function(e){c(e)&&(s=e)},sync:function(){if(s!==e){var t=u(),r=t[a]||0,i=l(),n=i[a];if(!n||triggermail.lytics._.isEmptyObject(i))return void p();var o=function(e,t){return JSON.stringify(e,Object.keys(e).sort())===JSON.stringify(t,Object.keys(t).sort())};if(!o(t,i)){var c=!r||r>n;f(i,t,c),d(i,t)}}},props:function(){return s===e?u():l()},read_prop:function(t){var r;return r=s===e?u()[t]:l()[t],"undefined"!=typeof r?r:null},write_prop:function(t,r){s===e?m(t,r):(h(t,r),this.sync())},remove_prop:function(t){s===e?_(t):(_(t),y(t))}}}(),triggermail.util=triggermail.util||{},triggermail.lytics._.extend(triggermail.util,{getNestedProp:function(e,t){try{if("string"!=typeof e)return;var r=t||window,i=e.split(".");if(0===i.length)return;for(var n=function(e,t,i){var n=t[i];return 0===i?r[n]:e[n]},o=0,a={};o<i.length&&"undefined"!=typeof a;)a=n(a,i,o),o+=1;return a}catch(e){}},listenAndIdentify:function(e,t,r,i,n,o){try{jQuery(document).on(i||"focusout",e,function(){var e=this;triggermail.util.wrapEvent(function(){var i=jQuery(n||e).val(),a=triggermail.identifySource[t];a&&(triggermail.util.validateAndIdentify(i,a,o),r&&triggermail.custom("welcome_qualifier",{source:a}))})()})}catch(e){}},executeOnTruthy:function(e,t,r,i,n){if("function"!=typeof e)throw"first argument should be a function to evaluate";if("function"!=typeof t)throw"second argument should be a function to execute if the first function evaluates to truthy";var o;o="number"==typeof r&&r>=1&&Math.floor(r)===r?r:3;var a;a="number"==typeof i&&i>100?i:500;var s;s="function"==typeof n?n:function(){},function r(i){var n=i;setTimeout(function(){var i=e();i?t():--n?r(n):s()},a)}(o)},registerCoom:function(e){var t=triggermail.persist.read_prop("tm_coom"),r=triggermail.persist.read_prop("email"),i=triggermail.persist.read_prop("bc_id");if(!(i||t||r&&triggermail.util.isValidEmail(r)))return triggermail.persist.write_prop("tm_coom",!0),triggermail.track("identify",{customer:e}),e},getDataLayerObj:function(e,t,r){var i=window[t]||window.dataLayer;if("undefined"!=typeof i&&"undefined"!=typeof e&&("undefined"==typeof r||"boolean"==typeof r))for(var n=function(e,t,r){return r?e>=0:e<t.length},o=function(e,t){return t?e-1:e+1},a=function(e,t){return t?e.length-1:0},s=a(i,r);n(s,i,r);s=o(s,r)){var c=i[s];if("undefined"!=typeof c[e])return c}},euroPrice:function(e){try{var t=e.replace(/[^0-9.,]/g,""),r=/[0-9]+,[0-9]{2}$/.test(t);if(r){var i=t.substr(0,t.length-3).replace(/\./g,"")+"."+t.substr(t.length-2);return parseFloat(i)}return parseFloat(t.replace(/,/g,""))}catch(e){}},handleS7Image:function(e,t,r,i){var n=e,o="wid="+(t||"920"),a="qlt="+(r||"90"),s=[o,a,"op_sharpen=1"];return"object"==typeof i&&i.length>0&&(s=s.concat(i)),n.indexOf("?")===-1&&(n+="?"),n.indexOf("$")===-1&&(n+="$"),n.replace(/\$.*/g,s.join("&"))}}),triggermail.integ=function(){return{init:function(){if(!triggermail.util.getUrlParam("bluecore_do_not_track")){"undefined"!=typeof triggermail.Partner.init?triggermail.Partner.init():triggermail.integ.partnerInit();try{triggermail.integ.checkLoop()}catch(e){}}},partnerInit:function(e){var t=triggermail.Partner;if("undefined"!=typeof e||!triggermail.lytics._.dom_query(".translated-rtl, .translated-rtl, #goog-gt-tt").length&&!triggermail.lytics._.dom_query('meta[http-equiv="X-Translated-By"]').length){try{t.trackProductView()}catch(e){e.location="trackProductView",triggermail.exception(e)}try{t.trackAddToCart()}catch(e){e.location="trackAddToCart",triggermail.exception(e)}try{t.trackCheckout()}catch(e){e.location="trackCheckout",triggermail.exception(e)}try{t.watchEmail()}catch(e){e.location="watchEmail",triggermail.exception(e)}if(t.hasOwnProperty("trackRemoveFromCart"))try{t.trackRemoveFromCart()}catch(e){e.location="trackRemoveFromCart",triggermail.exception(e)}if(t.hasOwnProperty("trackCheckoutStart"))try{t.trackCheckoutStart()}catch(e){e.location="trackCheckoutStart",triggermail.exception(e)}if(t.hasOwnProperty("trackUnsubscribe"))try{t.trackUnsubscribe()}catch(e){e.location="trackUnsubscribe",triggermail.exception(e)}if(t.hasOwnProperty("trackSubscribe"))try{t.trackSubscribe()}catch(e){e.location="trackSubscribe",triggermail.exception(e)}if(t.hasOwnProperty("trackSearch"))try{t.trackSearch()}catch(e){e.location="trackSearch",triggermail.exception(e)}if(t.hasOwnProperty("trackBrowseCategory"))try{t.trackBrowseCategory()}catch(e){e.location="trackBrowseCategory",triggermail.exception(e)}if(t.hasOwnProperty("trackWishlist"))try{t.trackWishlist()}catch(e){e.location="trackWishlist",triggermail.exception(e)}if(t.hasOwnProperty("trackContentView"))try{t.trackContentView()}catch(e){e.location="trackContentView",triggermail.exception(e)}if(t.hasOwnProperty("trackStop"))try{t.trackStop()}catch(e){e.location="trackStop",triggermail.exception(e)}if(triggermail.Partner.hasOwnProperty("trackCustom"))try{triggermail.Partner.trackCustom()}catch(e){triggermail.exception(e)}}},checkLoop:function(){if("undefined"==typeof triggermail.Partner.disableEmailAppendPickup||0==triggermail.Partner.disableEmailAppendPickup){for(var e=window.location.search.split("&"),t=0;t<e.length;t++){try{var r=triggermail.util.b64decode(decodeURIComponent(e[t].split("=").slice(1).join("=")))}catch(e){}if(r&&/^(([^<>{}()\[\]\.,;:\s@\"]+(\.[^<>{}()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>{}()[\]\.,;:\s@\"]+\.)+[^<>{}()[\]\.,;:\s@\"]{2,})/.test(r)&&triggermail.util.isValidEmail(r))return void triggermail.identify({email:r,source:triggermail.identifySource.ESP_EMAIL_APPEND,source_detail:"encoded"})}var i=triggermail.util.getUrlParam("tme");if(i.length>0)return void triggermail.identify({email:i,source:triggermail.identifySource.ESP_EMAIL_APPEND,source_detail:"tme"},!0);var i=decodeURIComponent(location.search).match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi)||decodeURIComponent(location.hash).match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(i&&triggermail.util.isValidEmail(i[0]))return void triggermail.identify({email:i[0],source:triggermail.identifySource.ESP_EMAIL_APPEND,source_detail:"plain text"})}var n=triggermail.util.getUrlParam("obem");if("undefined"!=typeof n&&""!=n&&triggermail.identify({obem:n,source:triggermail.identifySource.OBEM_EMAIL_APPEND}),triggermail.lytics._.dom_query("#bluecore_purchase_pixel").length>0&&"undefined"!=typeof triggermail.lytics._.dom_query("#bluecore_purchase_pixel")[0]){var o=triggermail.lytics._.dom_query("#bluecore_purchase_pixel")[0].src,i=triggermail.util.getParamFromQueryString(o,"email");triggermail.identify({email:i,source:triggermail.identifySource.BLUECORE_PURCHASE_PIXEL})}triggermail.lytics._.addEvent(document,"bc:identify",triggermail.util.wrapEvent(function(e,t){triggermail.util.isValidEmail(t.email)&&triggermail.identify({email:t.email,source:triggermail.identifySource.CUSTOM,source_detail:"dom event"})}))}}}(),triggermail.integ.ProductFetcher=__tmClass.extend({name:function(){return this._name},readOg:function(e){},category:function(){return this._category},color:function(){return this._color},size:function(){return this._size},price:function(){return this._price},brand:function(){return this._brand},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},out_of_stock:function(){return!1},tags:function(){return this._tags},to_dict:function(){try{var e={name:triggermail.core.sanitizer.sanitize("name",this.name()),category:triggermail.core.sanitizer.sanitize("category",this.category()),size:triggermail.core.sanitizer.sanitize("size",this.size()),price:triggermail.core.sanitizer.sanitize("price",this.price()),brand:triggermail.core.sanitizer.sanitize("brand",this.brand()),id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),url:triggermail.core.sanitizer.sanitize("url",this.url()),out_of_stock:this.out_of_stock(),tags:this.tags(),color:triggermail.core.sanitizer.sanitize("color",this.color())};for(var t in e)""!==e[t]&&0!=e[t]||"out_of_stock"==t||delete e[t];return triggermail.lytics._.extend(e,this.extra_props()),e}catch(e){e.location="product_fetcher",triggermail.exception(e)}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}}),triggermail.integ.ContentFetcher=__tmClass.extend({name:function(){return this._name},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},title:function(){return this._title},to_dict:function(){try{var e={id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),name:triggermail.core.sanitizer.sanitize("name",this.name()),title:triggermail.core.sanitizer.sanitize("title",this.title()),url:triggermail.core.sanitizer.sanitize("url",this.url())};for(var t in e)""!==e[t]&&0!=e[t]||delete e[t];return triggermail.lytics._.extend(e,this.extra_props()),e}catch(e){e.location="content_fetcher",triggermail.exception(e)}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}}),triggermail.integ.initServices=function(){triggermail.lytics.init(triggermail.integ.keys.lytics),triggermail.lytics=window["triggermail.lytics"],triggermail.lytics.set_config({save_referrer:!1,store_google:!1,debug:triggermail.integ.debug}),triggermail.persist.sync()},triggermail.fetcher=triggermail.integ.ProductFetcher.extend({init:function(){try{this.pageProductData=gap.pageProductData}catch(e){}},name:function(){return this.pageProductData.name},category:function(){},id:function(){return triggermail.util.getUrlParam("pid").trim().slice(0,9)},url:function(){return window.location.href.split("?")[0]+"?pid="+this.id()},brand:function(){return triggermail.Helpers.getBrand()},image:function(){try{if("/"!==this.pageProductData.currentColorMainImagr)return window.location.protocol+"//"+window.location.hostname+this.pageProductData.currentColorMainImage}catch(e){}},price:function(){try{return triggermail.util.price(this.pageProductData.currentMaxPrice)}catch(e){}},out_of_stock:function(){return!1},extra_props:function(){var e={};try{e.original_price=triggermail.util.price(this.pageProductData.regularMaxPrice),e.on_sale=e.original_price>this.price()}catch(e){}try{e.price_percentage_off=this.pageProductData.maxPercentageOff,e.parent_has_price_range=this.pageProductData.currentMinPrice<this.pageProductData.currentMaxPrice}catch(e){}try{e.p_color=jQuery("span.label:contains(Color)").closest("div.label-wrapper").find("span.value").text().trim()}catch(e){}try{e.currency=window.triggermail_currency_code}catch(e){}try{e.root_id=this.pageProductData.styleId}catch(e){}try{jQuery(".swatches.swatches_dimension label").length?(e.quantity_total_skus=jQuery(".swatches.swatches_dimension label").length,e.quantity_out_of_stock=jQuery(".swatches.swatches_dimension label svg.swatch__out-of-stock-indicator").length):jQuery("label.swatch.swatch-dimension").length&&(e.quantity_total_skus=jQuery("label.swatch.swatch-dimension").length,e.quantity_out_of_stock=jQuery("label.swatch.swatch-dimension .swatches--unavailable").length),e.quantity_in_stock=e.quantity_total_skus-e.quantity_out_of_stock,e.percent_out_of_stock=Math.floor(e.quantity_out_of_stock/e.quantity_total_skus*100)}catch(e){}try{e.cid=this.pageProductData.categoryId}catch(e){}try{e.brand=triggermail.Helpers.getBrand();var t;t=jQuery('meta[name="keywords"]').length>0?jQuery('meta[name="keywords"]').attr("content").split(",").slice(1):window.triggermail_page_name.split(":").slice(2,4),triggermail.util.getUrlParam("cid")&&(triggermail.Helpers.checkDivision(t[0])&&(e.division=t[0].trim(),e.division_cid=triggermail.Helpers.mapDivisionToCid(e.division,e.brand)),triggermail.Helpers.checkCategory(t[1])&&(e.category=t[1].trim()))}catch(e){}return jQuery.extend(e,triggermail.Localizers.additionalProps(this)),e}}),triggermail.Helpers=function(){return{getBrand:function(){var e=window.location.hostname;return/oldnavy/.test(e)?"old_navy":/athleta/.test(e)?"athleta":/bananarepublicfactory/.test(e)?"banana_republic_factory":/bananarepublic/.test(e)?"banana_republic":/gapfactory/.test(e)?"gap_factory":window.location.href.match("www.gap.com|m.gap.com|www.gapcanada.ca|m.gapcanada.ca|www.gap.co.uk|m.gap.co.uk|www.gap.eu|m.gap.eu|www.gap.co.jp|m.gap.co.jp")?"gap":""},doProductView:function(){var e=new triggermail.fetcher,t=e.to_dict();t.id&&triggermail.view(t)},checkForProductData:function(){return"object"==typeof triggermail.util.getNestedProp("gap.pageProductData")},checkForCartConfirmModal:function(){return!!jQuery("#modalWindow div.modal-body div.insitu-sku").length},formatSearchTerm:function(e,t){var r="brand:"+t+" AND "+e.toLowerCase().replace(/-|&|;|:|,|<|\?|>|\/|\\|\+|"|'|\$|amp/g,"").replace("womens","women").replace(/shop all| all \w+|by fit|by style|shop|by occasion|by style|null/gi,"").trim();return r},checkDivision:function(e){var t=e.toLowerCase().replace(/'s|clothing|clothes|apparel|sale|clearance|new arrivals/g,"").trim();return/athleta girl|baby girl|baby boy|baby|boys|footwear and accessories|gapbody|gapfit|gapmaternity|girls|jewelry & accessories|maternity|petites|shoes & accessories|shoes & handbags|shoes|tall|toddler girl|toddler boy|toddler|tops and jackets|women|men|kids/.test(t)},checkCategory:function(e){var t=e.toLowerCase().replace(/'s|clothing|clothes|apparel|sale|clearance|new arrivals/g,"").trim();return/2-piece sets|activewear|active bottoms|active tops|backpacks|bags & leather goods|bags|base layer|belts|blazers|bloomers|blouses & shirts|bodysuits & tops|boots & booties|boots|bottoms|bracelets|bras|brooches|capris & shorts|casual shirts|chinos|clutches & wallets|clutches & pouches|coats & jackets|cold weather accessories|cold weather|cover-ups|crops & capris|crops|crossbody bags|cycle & spin|denim|dress shirts|dresses & rompers|dresses & skirts|dresses, rompers & bubbles|dresses|earrings|flats|fleece & sweaters|graphic t-shirts|graphic tees|graphics|gym & training|hair accessories|handbags|hats & gloves|hats|heritage|hike|high heels|home & gifts|hoodies & jackets|hoodies & sweatpants|hoodies & outerwear|hoodies|intimates|jackets & coats|jackets and vests|jackets & outerwear|jackets|jeans & pants|jeans|jewelry|jewellery|joggers|jumpsuits & rompers|knickers|leggings & pants|leggings & joggers|leggings & trousers|leggings|loungewear|maternity|monogram|multi- packs|multi-packs|necklaces|nursing|nursing tops|one pieces|one-pieces|outerwear & jackets|outerwear & sweaters|outerwear|paddle board|panties|pants & leggings|pants, capris & shorts|pants|performance footwear|polos & shirts|polos|pumps|pure body collection|pure body|rashguards|rings and more|rings|rompers & jumpsuits|rompers|run|sandals|satchels|scarves|sets & packs|shirts & blouses|shirts & polos|shirts|shoes & accessories|shoes accessories|accessories|shoes & sneakers|shoes|shorts & capris|shorts & skirts|shorts & swim|shorts|skirts & skorts|skirts|skorts|sleep & lounge|sleep|sleepwear & loungewear|sleepwear & underwear|sleepwear|sneakers|socks & tights|socks & underwear|socks and tights|socks|sport bras|sports bras|sport bottoms|sport tops|suiting|suit collections|suits|sunglasses|support tops|sweaters & cardigans|sweaters & fleece|sweaters & jackets|sweaters & sweatshirts|sweaters|sweatshirts & sweatpants|sweatshirts|swim bottoms|swim dresses|swim tops|swimwear & cover-ups|swimwear|swim|t-shirts & tops|t-shirts|tees & knits|tees & tanks|tees & tops|tennis & golf|tops & t-shirts|tops|totes|triathlon|trousers|trousers & jeans|tunics|underwear & socks|underwear|uniforms|vests|yoga & studio/.test(t)},patchReviewInfo:function(){triggermail.util.executeOnTruthy(function(){return!!jQuery('button[itemprop="ratingValue"]').length},function(){try{var e=jQuery('button[itemprop="ratingValue"]').first().text(),t=jQuery("button.bv_numReviews_text").first().text().match(/\d+/)[0],r=triggermail.util.getUrlParam("pid").trim().slice(0,9);parseInt(t)>0&&Math.random()<.15&&triggermail.patch({products:[{id:r,product_review_average:e,number_of_reviews:t}]})}catch(e){}})},mapDivisionToCid:function(e,t){try{var r;if(window.location.hostname.indexOf("gap.com")>-1)return"old_navy"===t?e.indexOf("plus")>-1?r="5585":e.indexOf("maternity")>-1?r="5758":e.indexOf("women")>-1?r="5360":e.indexOf("men")>-1?r="5155":e.indexOf("baby")>-1?r="51375":e.indexOf("toddler")>-1?r="6241":e.indexOf("boy")>-1?r="5910":e.indexOf("girl")>-1&&(r="6027"):"gap"===t?e.indexOf("maternity")>-1?r="5997":e.indexOf("gapfit")>-1?r="83062":e.indexOf("women")>-1?r="5646":e.indexOf("men")>-1?r="5065":e.indexOf("baby")>-1?r="6487":e.indexOf("toddler")>-1?r="6413":e.indexOf("girl")>-1?r="6256":e.indexOf("boy")>-1&&(r="6172"):"banana_republic"===t?e.indexOf("petite")>-1?r="5122":e.indexOf("shoe")>-1?r="13358":e.indexOf("accessories")>-1?r="13915":e.indexOf("women")>-1?r="5002":e.indexOf("men")>-1&&(r="5343"):"athleta"===t?e.indexOf("athleta girl")>-1?r="1054832":e.indexOf("swim")>-1?r="46656":e.indexOf("shoe")>-1||e.indexOf("footwear")>-1?r="46866":e.indexOf("dress")>-1?r="46831":e.indexOf("jacket")>-1?r="60402":e.indexOf("top")>-1?r="46750":e.indexOf("bottom")>-1&&(r="46793"):"gap_factory"===t?e.indexOf("women")>-1?r="1040941":e.indexOf("men")>-1?r="1040942":e.indexOf("kid")>-1?r="1040943":e.indexOf("baby")>-1&&(r="1040944"):"banana_republic_factory"===t&&(e.indexOf("petite")>-1?r="1044621":e.indexOf("women")>-1?r="1044620":e.indexOf("men")>-1&&(r="1044619")),
r}catch(e){}}}}(),triggermail.Partner=function(){try{var e=triggermail.util.getUrlParam("cid")}catch(e){}try{var t=triggermail.Helpers.getBrand()}catch(e){}try{var r=triggermail.util.getUrlParam("pid").trim().slice(0,9)}catch(e){}return{trackProductView:function(){r&&triggermail.util.executeOnTruthy(triggermail.Helpers.checkForProductData,function(){triggermail.Helpers.doProductView(),triggermail.Helpers.patchReviewInfo()},3,500,function(){triggermail.view({id:r})})},trackAddToCart:function(){triggermail.util.executeOnTruthy(triggermail.Helpers.checkForCartConfirmModal,function(){var e=jQuery("#modalWindow div.modal-body div.insitu-sku").first().text().slice(1,10);triggermail.add_to_cart({id:e})}),jQuery(document).ajaxComplete(function(e,t,r){try{if(r.url.indexOf("inlineShoppingBagAdd")>-1){var i=triggermail.util.getParamFromQueryString(r.url,"skuid").slice(0,9);i&&triggermail.add_to_cart({id:i})}}catch(e){}})},trackRemoveFromCart:function(){try{if("ShoppingBag"===window.triggermail_page_type){var e=jQuery.map(jQuery("dd.productSku"),function(e){return{id:jQuery(e).text().slice(1,10)}});e.length>0&&triggermail.view_cart({products:e}),jQuery(document).on("mousedown","div.productDetails button.xGrayIcon",function(){try{var e=jQuery(this).closest("div.productDetails").find("dd.productSku").text().slice(1,10);e&&triggermail.remove_from_cart({id:e})}catch(e){}})}}catch(e){}},trackCheckout:function(){},trackBrowseCategory:function(){if(/^Category$/.test(window.triggermail_page_type)){if(triggermail.Localizers.excludedCids.indexOf(e)>-1)return;if("string"!=typeof window.triggermail_page_name||/^null$|solde|sale/i.test(window.triggermail_page_name))return;var r=window.triggermail_page_name.split(":").slice(2),i=r.join(" ").toLowerCase(),n=triggermail.Helpers.formatSearchTerm(i,t);if(!n||/event|new arrivals|sale|clearance|trend|deal|by size|%|from|collection/.test(n))return;/old_navy/.test(t)&&(n=n+" OR "+e),triggermail.search({search_term:n})}},trackSearch:function(){if(/^Search$/.test(window.triggermail_page_type)){var e=triggermail.util.getUrlParam("searchText");if(!e)return;e="brand:"+t+" AND "+e,triggermail.search({search_term:e})}},watchEmail:function(){var e=triggermail.util.cookie.get("customerId")||window.location.href.indexOf("customerService")===-1&&triggermail.util.getNestedProp("personalizationService.model.personalizationData.personalizationInfoV1.customerId");e&&(e=e.replace(/\|/g,""),triggermail.lytics.cookie.props.distinct_id="ci_"+e,triggermail.lytics.register({ci:e}),triggermail.lytics.cookie.save())},trackSubscribe:function(){try{jQuery(document).on("submit","form#SignInForm",function(){try{var e=jQuery(this).find("input#emailAddress").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.ACCOUNT_LOGIN)}catch(e){}}),jQuery(document).on("submit","form#RegisterForm",function(){try{var e=jQuery(this).find("input#newEmailAddress").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.ACCOUNT_REGISTER)}catch(e){}}),jQuery(document).on("submit","form#joinEmail_gap-ftr",function(){try{var e=jQuery(this).find("input#email-ftr").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.EMAIL_SIGNUP)}catch(e){}}),jQuery(document).on("submit",'div[id^="OldNavyEmailFooter"] form',function(){try{var e=jQuery(this).find("input#ftr-emailaddr").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.EMAIL_SIGNUP)}catch(e){}}),jQuery(document).on("submit","form#EmailRegistrationForm",function(){try{var e=jQuery(this).find("input#enter_emailFooter1input").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.EMAIL_SIGNUP)}catch(e){}}),jQuery(document).on("submit","form#joinEmail_Athleta_footer",function(){try{var e=jQuery(this).find("input#emailaddr2").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.EMAIL_SIGNUP)}catch(e){}}),jQuery(document).on("submit","form#exit_Intent_Modal_Custom",function(){try{var e=jQuery(this).find("input#email-ftr").val();triggermail.util.validateAndIdentify(e,triggermail.identifySource.EMAIL_CAPTURE_POPUP)}catch(e){}})}catch(e){}},trackWishlist:function(){},trackCustom:function(){try{if("outfit"===triggermail.util.getNestedProp("gap.appDataLayerAttributes.page_type")){var e=jQuery("#moduleProductName a").map(function(e,t){return{id:triggermail.util.getParamFromQueryString(jQuery(t).attr("href"),"pid")}});e.each(function(e,t){triggermail.view(t,{view_source:"outfit"})})}}catch(e){}try{if(jQuery("div#outofStock-wrapper").length>0||jQuery(".heading-d").text().toLowerCase().match("available|out of stock")||jQuery(".OutOfStockNoResultsPage").length>0||jQuery(".soldOutDiv").length>0){var t=triggermail.util.getParamFromQueryString(decodeURIComponent(window.location.href),"pid");t&&triggermail.patch({products:[{id:t,out_of_stock:!0}]})}}catch(e){}},trackUnsubscribe:function(){},env:function(){return"d"},keys:{lytics:{d:"dev"}}}}(),triggermail.Localizers=function(){return{excludedCids:["61185","61082","1000543","61243","84069","57959","58051","1029868","1025786","1025787","1025772","1025773","1025775","1025785","1025781","1025778","1025779","1025784","1025788","1025789","1025792","1025793","1025797","1025799","1025801","1025803","1025802","60645","1027279","1021773","1021770","87945","85958","88682","1027946","60646","60650","1027994","60648","1030608","60868","60846","60867"],additionalProps:function(e){var t={};try{if(triggermail.util.cookie.get("locale").toLowerCase().indexOf("fr_ca")>-1){t.name_fr=e.pageProductData.name,t.url_fr=e.url()+"&locale=fr_CA";var r;r=jQuery('meta[name="keywords"]').length>0?jQuery('meta[name="keywords"]').attr("content").split(",").slice(1):window.triggermail_page_name.split(":").slice(2,4),triggermail.Helpers.checkDivisionFr(r[0])&&(t.division_fr=r[0].trim()),triggermail.Helpers.checkCategoryFr(r[1])&&(t.category_fr=r[1].trim())}}catch(e){}return t}}}(),triggermail.Helpers.checkDivisionFr=function(e){var t=e.toLowerCase().replace(/'s|habillement|solde|liquidation|nouveaut\.s/g,"").trim();return/b.b. fille|b.b. gar.on|b.b.|gar.on|gapbody|gapfit|gapmaternity|fille|bijoux et accessoires|maternit.|petite|chaussures|toute-petite fille|tout-petit gar.on|tout-petit|femme|homme/.test(t)},triggermail.Helpers.checkCategoryFr=function(e){var t=e.toLowerCase().replace(/'s|habillement|solde|liquidation|nouveaut\.s/g,"").trim();return/accessoires pour temps froid|accessoires|barboteuses|barre|blazers|blouses et chemises|blouses et chemisiers|boucles d'oreilles|boutique baignade|bracelets|broches|cache-couches et hauts|ceintures|chandails et molleton|chandails et pulls . capuchon|chandails . capuchon et bas et molleton|chandails . capuchon et pantalons en molleton|chandails et pantalons en molleton|chandails et vestes|chandails|chapeaux et gants|chaussettes et collants|chaussettes et sous-v.tements|chaussettes|chaussures et accessoires|chaussures|chemises d.contract.es|chemises et polos|chemises|chemisiers et blouses|chemisiers|chinos|collection baignade|collants|colliers|complets|course|culottes|denim|ensembles|.charpes|fourre-tout|gapbody|gapfit|hauts|indispensables si pur|jeans et pantalons|jeans|jupes|leggings|leggings & pantalons|les accessoires|les bijoux|les sacs . main|maillots et hauts|molleton & chandails|molleton et chandails|nos tailleurs|pantalons d'entra.nement et pantalons en molletonen molleton|pantalons en velours c.tel.|pantalons et capris|pantalon d'exercice|pantalons et leggings|pantalons|polos|pulls . capuchon et vestes|pulls molletonn.s & et plus|pulls molletonn.s et plus|pulls|pyjama|robes et jupes|robes et barboteuses|robes|sacs . bandouli.re|sacs et articles de maroquinerie|sacs|sans repassage chemises habill.es|shorts et barboteuses|shorts et boutique baignade|shorts et collection baignade|shorts et capris|shorts|sous-v.tements et chaussettes|sous-v.tements|soutiens-gorge de sport|soutiens-gorge sport|soutiens-gorge|superposition de base|t-shirts et hauts|t-shirts imprim.s|t-shirts avec imprim.s|t-shirts et d.bardeurs|t shirts|t-shirts|t-shirt|tees et polos|tee|temps foid|tendances mode|toile de jean|trois quarts|une-pi.ces|uniformes scolaires|uniformes|velours c.tel.|vestes et chandails . capuchon|v.tements d'exercice|v.tements d'ext.rieur et vestes|v.tements d'ext.rieur|v.tements de nuit et de d.tente|v.tements de nuit et v.tements de d.tente|v.tements de nuit|yoga/.test(t)},triggermail.Helpers.doProductView=function(){var e=new triggermail.fetcher,t=e.to_dict();t.id&&(triggermail.util.cookie.get("locale").toLowerCase().indexOf("fr_ca")>-1?triggermail.view({id:t.id,name_fr:t.name_fr,url_fr:t.url_fr,division_fr:t.division_fr,category_fr:t.category_fr}):triggermail.view(t))},triggermail.Partner.env=function(){return!(window.location.hostname.indexOf("gapcanada.ca")>-1)||window.location.hostname.indexOf("gol.app.gid.")>-1||window.location.hostname.indexOf("gidapps.")>-1?"d":"p"},triggermail.Partner.keys={lytics:{d:"dev",p:"gapinc_ca"}};var t=function(){var e="__bc_audience_sync",t=function(){var t=function(t){var r=t.target;if(r.readyState===XMLHttpRequest.DONE){var i,n=function(t){triggermail.util.cookie.set(e,JSON.stringify(t),void 0,triggermail.lytics.cookie.get_cross_subdomain())},o=function(e){triggermail.util.cookie.get(e)||triggermail.util.cookie.set(e,"true",void 0,triggermail.lytics.cookie.get_cross_subdomain())},a=function(e){triggermail.util.cookie.get(e)&&triggermail.util.cookie.remove(e,triggermail.lytics.cookie.get_cross_subdomain())},s=[],c=!!r.responseText,u={};try{u=c?JSON.parse(r.responseText):{}}catch(e){}c&&triggermail.lytics._.each(u,function(e,t){s.push(t),o(t)}),i=triggermail.util.cookie.get(e),i=i?JSON.parse(i):{},triggermail.lytics._.each(i.audiences||[],function(e){s.indexOf(e)===-1&&a(e)}),i={lastSyncTime:+new Date,audiences:s},n(i)}},r=new XMLHttpRequest,i="//bluecore.com/api/audiences/get_audience_info";i+="?namespace="+encodeURIComponent(triggermail.integ.keys.lytics),i+="&customer_alias="+encodeURIComponent(triggermail.lytics.get_distinct_id()),i+="&_"+(new Date).getTime(),r.open("GET",i),r.onreadystatechange=t,r.send()},r=triggermail.util.cookie.get(e);r=r?JSON.parse(r):{};var i=+(r.lastSyncTime||0),n=+new Date,o=36e5;n-i>o&&t()};triggermail.initialize=function(){triggermail.integ.keys={};var e=triggermail.Partner.env();triggermail.integ.keys.lytics=triggermail.Partner.keys.lytics[e],triggermail.integ.debug=!1,triggermail.integ.initServices(),triggermail.init();var r=["124_rivington","lucy","nat_geo","servermonkey","vans"];r.indexOf(triggermail.integ.keys.lytics)>-1&&t();var i=triggermail.util.getUrlParam("__distinct_id_override__");""!==i&&triggermail.persist.write_prop("distinct_id",i);var n=triggermail.util.getUrlParam("mc_eid"),o=triggermail.persist.read_prop("distinct_id");n&&n.toLowerCase().indexOf("uniqid")===-1&&o!==n&&(n="mceid_"+n,o!==n&&(triggermail.merge({merge:{source:o,destination:n},customer:{distinct_id:n}}),triggermail.persist.write_prop("distinct_id",n),triggermail.persist.write_prop("mc_eid",n))),triggermail.integ.init();var a=triggermail.util.getUrlParam("__auto_demo__");""!==a&&(triggermail.demo(),triggermail.identify({email:a}))},e(0)}else window.setTimeout(__xx_checkJquery,100)}window.jQuery||!function(){var e=document.createElement("script");e.type="text/javascript",e.src=("https:"===document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),__xx_checkJquery();