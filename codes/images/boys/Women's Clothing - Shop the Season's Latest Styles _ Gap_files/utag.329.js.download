//tealium universal tag - utag.329 ut4.0.201909262253, Copyright 2019 Tealium.com Inc. All Rights Reserved.
var certona=certona||{};try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1};u.map={"certona_clientid":"cid","certona_domain":"domain","certona_pagetype":"page_type","certona_user_id":"customer_id","di_email_key":"emailcustomerid","category_id":"categoryid","division_id":"divisionid","subdivision_id":"subdivisionid","product_brand":"brand","brand_code":"site","certona_recs":"recommendations","language_code":"language_code","certona_oos_pid":"product_id","store_name_new":"newstorename","store_number_new":"newstorenumber","certona_divpref":"divpref","certona_catpref":"catpref"};u.extend=[function(a,b){try{if(1){if(b['qp.pwa']&&b['qp.pwa']=='true'){b['certona_domain']='oldnavy.gap.com';}
if(b['ut.env']=='qa'||b['ut.env']=='dev'){b['certona_domain']=b['certona_staging_domain'];}
if(b['country_code']=='US'&&b['is_react']){b['certona_domain']='www.gap.com';}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['page_type'];if(typeof d=='undefined')return;c=[{'Home':'HOME'},{'Division':'DIVISION'},{'Category':'CATEGORY'},{'Search':'SEARCH'},{'Product':'PRODUCT'},{'Profile':'ACCOUNT'},{'ShoppingBag':'CART'},{'OrderConfirmation':'PURCHASE'},{'Information':'CUSTOMERLANDING'},{'OutOfStockNoResults':'OUTOFSTOCK'},{'StoreLocator':'STORELOCATOR'}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['certona_pagetype']=c[e][f];m=true};};if(m)break};if(!m)b['certona_pagetype']='';}},function(a,b){try{if(1){if(b.page_type){if(b.page_type=="Division"&&b.business_unit_id==35){b.certona_pagetype="CATEGORYLANDING";}
if(b.page_type=="Search"&&b.internal_search_results==0){b.certona_pagetype="NOSEARCH";}
if(b.page_type=="Profile"&&b.page_name&&b.page_name.indexOf("Order History")>-1){b.certona_pagetype="ORDERHISTORY";}
if(b.page_type=="Profile"&&b.page_name&&b.page_name.indexOf(":Favorites")>-1){b.certona_pagetype="WISHLIST";}
if(b.page_type=="InlineBagAdd"&&b.is_react){b.certona_pagetype="ADDTOCART";}}
if(b['dom.url']&&b['dom.url'].indexOf("OutOfStockNoResults.do")>-1){b.certona_pagetype="OUTOFSTOCK";}
if(b.business_unit_id==1&&b["qp.cid"]=="1109097"){b.certona_pagetype="DENIM";}
if(b.business_unit_id==10&&b["qp.cid"]=="1131843"){b.certona_pagetype="PRODUCTFINDER";}
if(b.business_unit_id==10&&b["qp.cid"]=="1127248"){b.certona_pagetype="QUIZENTRY";}
if(b.tealium_profile=="usgap"&&b.page_type=="CustomerService"){b.certona_pagetype="CUSTOMERSERVICE";}
if((b.business_unit_id==1||b.business_unit_id==7)&&b["qp.cid"]=="1135579"){b.certona_pagetype="CUSTOMERLANDING2";}
if((b.business_unit_id==3||b.business_unit_id==9)&&b["qp.cid"]=="56526"){b.certona_pagetype="CUSTOMERLANDING2";}
if((b.business_unit_id==2)&&b["qp.cid"]=="1066225"){b.certona_pagetype="CUSTOMERLANDING2";}
if((b.business_unit_id==34)&&b["qp.cid"]=="1139739"){b.certona_pagetype="CUSTOMERLANDING2";}
if((b.business_unit_id==9)&&b["qp.cid"]=="1104520"){b.certona_pagetype="CUSTOMERLANDING3";}
if((b.business_unit_id==1)&&b["qp.cid"]=="1139737"){b.certona_pagetype="CUSTOMERLANDING3";}
if((b.business_unit_id==10)&&b["qp.cid"]=="82634"){b.certona_pagetype="ACCOUNT2";}
if((b.business_unit_id==1)&&b["qp.cid"]=="1141805"){b.certona_pagetype="CUSTOMERLANDING";}
if((b.business_unit_id==1)&&b["qp.cid"]=="1105989"){b.certona_pagetype="CUSTOMERLANDING4";}
if((b.business_unit_id==34)&&b["qp.cid"]=="1141806"){b.certona_pagetype="CUSTOMERLANDING3";}
if((b.business_unit_id==10)&&b["qp.cid"]=="1141763"){b.certona_pagetype="CUSTOMERLANDING2";}
if((b.business_unit_id==10)&&b["qp.cid"]=="1135654"){b.certona_pagetype="CUSTOMERLANDING3";}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['certona_pagetype'];if(typeof d=='undefined')return;c=[{'HOME':'true'},{'PRODUCT':'true'},{'CART':'true'},{'CUSTOMERLANDING':'true'},{'CATEGORYLANDING':'true'},{'CATEGORY':'true'},{'DIVISION':'true'},{'DENIM':'true'},{'OUTOFSTOCK':'true'},{'ADDTOCART':'true'},{'STORELOCATOR':'true'},{'CUSTOMERSERVICE':'true'},{'NOSEARCH':'true'},{'CUSTOMERLANDING2':'true'},{'CUSTOMERLANDING3':'true'},{'ACCOUNT2':'true'},{'CUSTOMERLANDING4':''}];var m=false;for(e=0;e<c.length;e++){for(f in c[e]){if(d==f){b['certona_recs']=c[e][f];m=true};};if(m)break};if(!m)b['certona_recs']='false';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"base_url":"//edge1.certona.net/cd/##utag_cid##/##utag_domain##/scripts/resonance.js","cid":"","domain":"","event":"","page_type":"NONE","filter":{},"product_id":[],"product_category":[],"product_quantity":[],"product_unit_price":[],};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
u.data.order_id=u.data.transactionid||u.data.order_id||b._corder||"";u.data.order_subtotal=u.data.total||u.data.order_subtotal||b._csubtotal||"";u.data.customer_id=u.data.customerid||u.data.customer_id||b._ccustid||"";if(u.data.product_id.length===0&&b._cprod!==undefined){if(typeof u.data.itemid==="undefined"){if(b._csku!=="undefined"&&b._csku.length>0){u.data.product_id=b._csku.slice(0);}else if(b['qp.pid']!==undefined){var wcdPid=b['qp.pid'].substr(0,9);u.data.product_id=[wcdPid];}else{u.data.product_id=b._cprod.slice(0);}}else{u.data.product_id=u.data.itemid.slice(0);}}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){if(typeof u.data.qty==="undefined"){u.data.product_quantity=b._cquan.slice(0);}else{u.data.product_quantity=u.data.qty.slice(0);}}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){if(typeof u.data.price==="undefined"){u.data.product_unit_price=b._cprice.slice(0);}else{u.data.product_unit_price=u.data.price.slice(0);}}
if(u.data.site){certona.site=u.data.site;}
certona.filter={};if(u.data.divpref){certona.filter.gender=u.data.divpref;}
if(u.data.catpref){certona.filter.category=u.data.catpref;}
if(u.data.newstorenumber){certona.filter.storenumber=u.data.newstorenumber;}
if(u.data.newstorename){certona.filter.storename=u.data.newstorename;}
if(u.data.page_type==="OTHER"){utag.DB("Warning: You've selected other as a page type and haven't overridden it in mapping.");}
if(u.data.page_type!=="NONE"){certona.pagetype=u.data.page_type;}
if(u.data.customer_id){certona.customerid=u.data.customer_id;}
if(u.data.page_type==="PURCHASE"||u.data.order_id){certona.pagetype="PURCHASE";certona.itemid=u.data.product_id.join(";");certona.qty=u.data.product_quantity.join(";");certona.brand=u.data.brand.join(";");certona.transactionid=u.data.order_id;var subtotal=0;for(var i=0;i<u.data.product_unit_price.length;i++){u.data.product_unit_price[i]=(parseFloat(u.data.product_unit_price[i])*parseFloat(u.data.product_quantity[i])).toFixed(2);subtotal+=parseFloat(u.data.product_unit_price[i]);}
certona.price=u.data.product_unit_price.join(";");certona.total=u.data.order_subtotal||subtotal;}else if(u.data.page_type==="PRODUCT"||u.data.page_type==="OUTOFSTOCK"){certona.itemid=u.data.product_id[0];}else if(u.data.page_type==="CART"){certona.itemid=u.data.product_id.join(";");certona.brand=u.data.brand.join(";");}else if(u.data.page_type==="CATEGORYLANDING"||u.data.page_type==="CATEGORY"||u.data.page_type==="DIVISION"){certona.categoryid=u.data.product_category[0]||u.data.categoryid||"";certona.divisionid=u.data.divisionid||"";certona.subdivisionid=u.data.subdivisionid||"";}
if(u.data.recommendations==="true"){certona.recommendations=true;}else{certona.recommendations=false;}
if(u.data.emailcustomerid){certona.emailcustomerid=u.data.emailcustomerid;}else{certona.emailcustomerid="";}
if(u.data.language_code){certona.languagecode=u.data.language_code;}
u.data.base_url=u.data.base_url.replace("##utag_cid##",u.data.cid);u.data.base_url=u.data.base_url.replace("##utag_domain##",u.data.domain);u.loader({"type":"script","src":u.data.base_url,"cb":null,"loc":"script","id":'utag_329'});}};utag.o[loader].loader.LOAD(id);}("329","gapinc.cagap"));}catch(error){utag.DB(error);}
