var wcdLib={version:"2.3.4",pageDataLayer:{},trackingQueue:[],tealiumBadges:{},tealiumProperties:{},LOCAL_STORAGE_KEY:"wcd",hasRemovedExpiredKeysInLS:!1,debugMode:!1,init:function(e){wcdLib.debugMode=location.search.indexOf("debug")>=0,jQuery(document).on("wcd_pageDataLayer:ready",function(e,a){void 0!==a&&(wcdLib.pageDataLayer=a,jQuery(document).trigger("wcdDataLayer:ready"))}),wcdLib.initTealiumData(e),wcdLib.removeExpiredValuesFromLS()},documentReady:function(e){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)},windowLoad:function(e){"complete"===document.readyState?e():window.addEventListener("load",e)},initTealiumData:function(e){wcdLib.loadAllStoredValues(),!1!==e&&wcdLib.showCardAndNonCardholderElements(),jQuery(document).trigger("wcd_tealium:ready")},showCardAndNonCardholderElements:function(){wcdLib.documentReady(function(){for(var e=wcdLib.isCardholder()?".cardholder":".non-cardholder",a=document.querySelectorAll(e),t=0;t<a.length;t++)a[t].style.display="block"})},loadAllStoredValues:function(){if("undefined"!=typeof Storage){var e=localStorage.getItem("tealium_va");null!==e&&(void 0!==(e=JSON.parse(e)).badges&&(wcdLib.tealiumBadges=e.badges),void 0!==e.properties&&(wcdLib.tealiumProperties=e.properties))}},isCardholder:function(e){var a=!1,t={on:34502,gp:35310,br:35316,at:35318,gpsliver:34514,brluxe:35314,navyist:34504,anycard:31876,nocard:31878,basic:34510,tiered:34512};return void 0===e?a=!0===wcdLib.tealiumBadges[t.anycard]||!0!==wcdLib.tealiumBadges[t.nocard]&&void 0!==wcdLib.tealiumBadges[t.nocard]:void 0!==(e=t[e.toLowerCase()])&&(a=void 0!==wcdLib.tealiumBadges[e]&&wcdLib.tealiumBadges[e]),a},isEmailSubscriber:function(e){var a=!1,t={on:43513,gp:42797,gpfs:43331,br:43511,brfs:43509,at:43515};return void 0===e?"undefined"!=typeof brandConst&&void 0!==brandConst.BRAND_ID&&(e=t[brandConst.BRAND_ID.toLowerCase()]):e=t[e.toLowerCase()],void 0!==e&&(a=void 0!==wcdLib.tealiumBadges[e]&&wcdLib.tealiumBadges[e]),a},getTealiumValue:function(e){e=parseInt(e,10);var a=void 0;return void 0!==wcdLib.tealiumBadges[e]?a=wcdLib.tealiumBadges[e]:void 0!==wcdLib.tealiumProperties[e]&&(a=wcdLib.tealiumProperties[e]),a},hasLocalStorage:function(e){var a=void 0===e?"localStorage":"sessionStorage",t=a+"Exists";if(void 0===wcdLib[t]){var i="test";try{window[a].setItem(i,i),window[a].removeItem(i),wcdLib[t]=!0}catch(e){wcdLib[t]=!1,22==e.code&&(wcdLib.removeExpiredValuesFromLS(),wcdLib.consoleLog("ERROR - hasLocalStorage (tried removing expired values) - "+e.name,e))}}return wcdLib[t]},getLocalStorageVar:function(e,a){var t="";if(wcdLib.hasLocalStorage()){var i=localStorage.getItem(wcdLib.LOCAL_STORAGE_KEY),o=function(e,a){var t="";return void 0!==e[a]&&(t=e[a]).indexOf("~")>=0&&(t=t.split("~")[0]),t};null!==i&&(t=o(i=JSON.parse(i),e)),""===t&&wcdLib.hasLocalStorage("session")&&null!==(i=sessionStorage.getItem(wcdLib.LOCAL_STORAGE_KEY))&&(t=(t=o(i=JSON.parse(i),e)).indexOf("~")>=0?t.split("~")[0]:t)}else!0===a?t=gidLib.getCookieVar("mktUniversalPersist",e):wcdLib.consoleLog("ERROR - getLocalStorageVar - trying to get value ("+e+") but LS doesn't exist");return t},setLocalStorageVar:function(e,a,t,i){var o="",n="localStorage",r=wcdLib.hasLocalStorage();if(void 0!==t&&""!==t&&"session"!==t?o="~"+t:"session"==t&&(n="sessionStorage",r=wcdLib.hasLocalStorage("session")),r){var d=window[n].getItem(wcdLib.LOCAL_STORAGE_KEY);(d=null!==d?JSON.parse(d):{})[e]=a+o,d=JSON.stringify(d);try{window[n].setItem(wcdLib.LOCAL_STORAGE_KEY,d)}catch(a){wcdLib.consoleLog("ERROR - setLocalStorageVar : "+e,a)}}else!0===i?gidLib.setCookieVar("mktUniversalPersist",e,a):wcdLib.consoleLog("ERROR - setLocalStorageVar - trying to set value ("+e+") but LS doesn't exist")},removeLocalStorageVar:function(e,a){var t=!1,i="localStorage";if(wcdLib.hasLocalStorage()){var o=localStorage.getItem(wcdLib.LOCAL_STORAGE_KEY);if(null!==o&&void 0!==(o=JSON.parse(o))[e]&&(t=!0),0==t&&wcdLib.hasLocalStorage("session")&&(i="sessionStorage",null!==(o=sessionStorage.getItem(wcdLib.LOCAL_STORAGE_KEY))&&void 0!==(o=JSON.parse(o))[e]&&(t=!0)),t){for(var n={},r=Object.keys(o),d=0;d<r.length;d++)r[d]!==e&&(n[r[d]]=o[r[d]]);n=JSON.stringify(n);try{window[i].setItem(wcdLib.LOCAL_STORAGE_KEY,n)}catch(a){wcdLib.consoleLog("ERROR - removeLocalStorageVar : "+e,a)}}}else!0===a&&gidLib.removeCookieVar("mktUniversalPersist",e)},removeExpiredValuesFromLS:function(){var e=function(){if(void 0!==personalizationService.model.personalizationData.personalizationInfoV1.userContext.viewDate){var e=personalizationService.model.personalizationData.personalizationInfoV1.userContext.viewDate;e=new Date(e).getTime();var a=localStorage.getItem(wcdLib.LOCAL_STORAGE_KEY);if(null!==a){a=JSON.parse(a);for(var t={},i=Object.keys(a),o=0;o<i.length;o++)if(a[i[o]].indexOf("~")>=0){var n=a[i[o]].split("~")[1];e<parseInt(n,10)&&(t[i[o]]=a[i[o]])}else t[i[o]]=a[i[o]];t=JSON.stringify(t);try{localStorage.setItem(wcdLib.LOCAL_STORAGE_KEY,t)}catch(e){wcdLib.consoleLog("ERROR - removeExpiredValuesFromLS",e)}}}};0==wcdLib.hasRemovedExpiredKeysInLS&&1==wcdLib.hasLocalStorage()&&(wcdLib.hasRemovedExpiredKeysInLS=!0,"undefined"!=typeof personalizationService&&void 0!==personalizationService.model&&void 0!==personalizationService.model.isPersonalizationDataReady&&!0===personalizationService.model.isPersonalizationDataReady?e():jQuery(document).on("personalizationData:ready",e))},consoleLog:function(e,a){wcdLib.debugMode&&(console.log("[ WCD ] "+e),void 0!==a&&console.log(a))},getAssetPath:function(e,a){a=a&&""!=a?a:"";var t="000"+e.substr(0,1)+"/"+e.substr(1,3)+"/"+e.substr(4,3);return"/Asset_Archive/"+gidBrandSiteConstruct.currentBrandSiteId+"Web/content/"+t+"/assets/"+a},trackValue:function(e,a,t,i){if(wcdLib.pageDataLayer.brand_short_name){var o="eVar7"==i?"content_id":"content_id_link",n=1;"undefined"!=typeof gidBrandSiteConstruct&&void 0!==gidBrandSiteConstruct.currentBrandCode&&(n=gidBrandSiteConstruct.currentBrandCode);var r={business_unit_id:n,link_name:t};r[o]=a,PageDataLayer.link(r)}else{wcdLib.trackingQueue.push({target:e,trackingId:a,linkName:t,evarToUse:i});var d=function(){if(wcdLib.isWindowReady&&wcdLib.isWCDDataLayer)for(var e={};wcdLib.trackingQueue.length>0;)e=wcdLib.trackingQueue.splice(0,1),wcdLib.trackValue(e[0].target,e[0].trackingId,e[0].linkName,e[0].evarToUse)};jQuery(window).on("load",function(){wcdLib.isWindowReady=!0,d()}),jQuery(document).on("wcdDataLayer:ready",function(){wcdLib.isWCDDataLayer=!0,d()})}},getCleanString:function(e,a){return e=e.replace(/^\s+|\t+|\n+| |\s+$/g,""),e=a?e.toLowerCase():e},getCurrentDivisionName:function(){var e="",a=wcdLib.pageDataLayer;return void 0!==a&&null!==a&&Object.keys(a).length>0&&void 0!==wcdLib.pageDataLayer.current_division&&(e=wcdLib.pageDataLayer.current_division),e},contentItemLinkWithFacet:function(e,a,t,o){var n=null,r="",d=null,s="string"==typeof e||"number"==typeof e,c=a&&""!=a;if(location.search.indexOf("cid=")>-1?(d=location.search.substr(location.search.indexOf("cid=")+4)).indexOf("&")>-1&&(d=d.substr(0,d.indexOf("&"))):"/"==location.pathname||"/browse/home.do"==location.pathname?d="5151":"/buy/shopping_bag.do"==location.pathname||"/buy/shopping_cart.do"==location.pathname?d="3090":"/checkout/orderConfirm.do"==location.pathname&&(d="36620"),""==d&&(d="other"),s)n=r=e;else{n=e;do{isFound=n&&n.id&&n.id.match(new RegExp("contentItemContainer"))||null==n,isFound||(n=n.parentNode)}while(!isFound);jQuery(n)&&(r=jQuery(n).attr("class"))}var l=function(e){var a="";return e.indexOf("#")>-1&&(a=e.substr(e.indexOf("#")),e=e.substr(0,e.indexOf("#"))),e+=(-1==e.indexOf("?")?"?":"&")+"mlink="+d+","+r+(t&&""!=t?","+t:"")+"&clink="+r,""!=a&&(e+=a),e};if(n){if(c||(e.useMap&&document.getElementsByName(e.useMap.substr(1)).length>0?strLink=document.getElementsByName(e.useMap.substr(1))[0].areas[0].href:e.href?strLink=e.href:e.parentNode&&e.parentNode.href&&(strLink=e.parentNode.href),a=strLink.replace(new RegExp(".+"+location.host),"")),a.match(/^(\/|http|about)/))a.match(/^\//)&&(a=l(a));else{var u=new RegExp(/[^']*\.do\?[^']*/g),L=a.match(u);if(L)for(i=0;i<L.length;i++)a=a.replace(L[i],l(L[i]))}if(o&&"_new"==o)window.open(a,"").focus();else(o&&window[o]?window[o]:window).location.href=a;if(!c)return!1}else if(!c)return!0},getQuerystringParam:function(e,a){var t=a?location.search:location.search.toLowerCase(),i=a?e:e.toLowerCase(),o="",n=new RegExp("[\\?&]"+i+"=([^&#]*)").exec(t);return null!==n&&(o=n[1]),decodeURIComponent(o)}};wcdLib.init(false);
var contentItemLink=wcdLib.contentItemLinkWithFacet,contentItemLinkWithFacet=contentItemLink;